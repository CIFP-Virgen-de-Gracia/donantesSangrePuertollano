{"ast":null,"code":"import { HttpHeaders } from '@angular/common/http';\nimport { tap } from 'rxjs';\nimport { environment } from 'src/environment/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class CitasService {\n  constructor(httpPedirCita) {\n    this.httpPedirCita = httpPedirCita;\n    this.pedirCitaUrl = `${environment.baseUrl}/api/citas`;\n  }\n  fetchHorasDisponibles(fecha) {\n    const header = {\n      headers: new HttpHeaders({\n        'Content-Type': 'application/json',\n        'x-token': JSON.parse(localStorage.getItem('user')).token\n      })\n    };\n    return this.httpPedirCita.get(this.pedirCitaUrl + '/gethorasdisponibles/' + fecha, header).pipe(tap(citas => this._citasReservadas = citas));\n  }\n  // fetchHorarioCitas() {\n  //   return this.httpPedirCita.get<interfaces.HorarioCitasResponse>(this.pedirCitaUrl\n  //     + '/gethorariocitas').pipe(tap(horas => this._horasCitas = horas));\n  // }\n  insertCita(id, fecha, donacion) {\n    const header = {\n      headers: new HttpHeaders({\n        'Content-Type': 'application/json',\n        'x-token': JSON.parse(localStorage.getItem('user')).token\n      })\n    };\n    return this.httpPedirCita.post(this.pedirCitaUrl + '/pedircita', {\n      id: id,\n      fecha: fecha,\n      donacion: donacion\n    }, header);\n  }\n  mandarCorreo(id, fecha, donacion) {\n    const header = {\n      headers: new HttpHeaders({\n        'Content-Type': 'application/json',\n        'x-token': JSON.parse(localStorage.getItem('user')).token\n      })\n    };\n    return this.httpPedirCita.post(this.pedirCitaUrl + '/mandarcorreocita', {\n      id: id,\n      fecha: fecha,\n      donacion: donacion\n    }, header);\n  }\n  fetchCitaPendiente(id) {\n    const header = {\n      headers: new HttpHeaders({\n        'Content-Type': 'application/json',\n        'x-token': JSON.parse(localStorage.getItem('user')).token\n      })\n    };\n    return this.httpPedirCita.get(this.pedirCitaUrl + '/getcitapendienteuser/' + id, header).pipe(tap(resp => {\n      this._citasPendientesUser = resp.citas;\n    }));\n  }\n  fetchCitasPasadas(id) {\n    const header = {\n      headers: new HttpHeaders({\n        'Content-Type': 'application/json',\n        'x-token': JSON.parse(localStorage.getItem('user')).token\n      })\n    };\n    return this.httpPedirCita.get(this.pedirCitaUrl + '/getcitaspasadasuser/' + id, header).pipe(tap(resp => {\n      this._citasPasadasUser = resp.citas;\n    }));\n  }\n  cancelarCita(id) {\n    const header = {\n      headers: new HttpHeaders({\n        'Content-Type': 'application/json',\n        'x-token': JSON.parse(localStorage.getItem('user')).token\n      })\n    };\n    return this.httpPedirCita.put(this.pedirCitaUrl + '/cancelarcita/', {\n      id: id\n    }, header);\n  }\n  compHaPedidoCita(id) {\n    const header = {\n      headers: new HttpHeaders({\n        'Content-Type': 'application/json',\n        'x-token': JSON.parse(localStorage.getItem('user')).token\n      })\n    };\n    return this.httpPedirCita.get(this.pedirCitaUrl + '/yatienecita/' + id, header);\n  }\n}\nCitasService.ɵfac = function CitasService_Factory(t) {\n  return new (t || CitasService)(i0.ɵɵinject(i1.HttpClient));\n};\nCitasService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: CitasService,\n  factory: CitasService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"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","names":["HttpHeaders","tap","environment","CitasService","constructor","httpPedirCita","baseUrl","fetchHorasDisponibles","fecha","header","headers","JSON","parse","localStorage","getItem","token","get","pedirCitaUrl","pipe","citas","_citasReservadas","insertCita","id","donacion","post","mandarCorreo","fetchCitaPendiente","resp","_citasPendientesUser","fetchCitasPasadas","_citasPasadasUser","cancelarCita","put","compHaPedidoCita","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\Alicia\\Documents\\Clase\\DAW\\Segundo\\Desafio3_DonantesSangre\\donantesSangrePuertollano\\front\\src\\app\\citas\\services\\citas.service.ts"],"sourcesContent":["import { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { tap } from 'rxjs';\r\nimport { environment } from 'src/environment/environment';\r\nimport * as interfaces from '../interfaces/citas.interface';\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class CitasService {\r\n  private pedirCitaUrl = `${environment.baseUrl}/api/citas`;\r\n  private _horasCitas: any;\r\n  private _citasReservadas: any;\r\n  private _citasPendientesUser: interfaces.Cita[];\r\n  private _citasPasadasUser: interfaces.Cita[];\r\n\r\n  constructor(private httpPedirCita: HttpClient) { }\r\n\r\n  fetchHorasDisponibles(fecha: string) {\r\n    const header = {\r\n      headers: new HttpHeaders({\r\n        'Content-Type': 'application/json',\r\n        'x-token': JSON.parse(localStorage.getItem('user')!).token\r\n      })\r\n    };\r\n    \r\n    return this.httpPedirCita.get<interfaces.HorarioCitasResponse>(this.pedirCitaUrl \r\n      + '/gethorasdisponibles/' + fecha, header).pipe(tap(citas => this._citasReservadas = citas));\r\n  }\r\n\r\n  // fetchHorarioCitas() {\r\n  //   return this.httpPedirCita.get<interfaces.HorarioCitasResponse>(this.pedirCitaUrl\r\n  //     + '/gethorariocitas').pipe(tap(horas => this._horasCitas = horas));\r\n  // }\r\n\r\n  insertCita(id: string, fecha: string, donacion: string) {\r\n    const header = {\r\n      headers: new HttpHeaders({\r\n        'Content-Type': 'application/json',\r\n        'x-token': JSON.parse(localStorage.getItem('user')!).token\r\n      })\r\n    };\r\n\r\n    return this.httpPedirCita.post<interfaces.SuccessMsgResponse>(this.pedirCitaUrl\r\n      + '/pedircita', {id: id, fecha: fecha, donacion: donacion}, header);\r\n  }\r\n\r\n\r\n  mandarCorreo(id:string, fecha: string, donacion: string) {\r\n    const header = {\r\n      headers: new HttpHeaders({\r\n        'Content-Type': 'application/json',\r\n        'x-token': JSON.parse(localStorage.getItem('user')!).token\r\n      })\r\n    };\r\n\r\n    return this.httpPedirCita.post<interfaces.SuccessMsgResponse>(this.pedirCitaUrl\r\n      + '/mandarcorreocita', {id: id, fecha: fecha, donacion: donacion}, header);\r\n  }\r\n\r\n\r\n  fetchCitaPendiente(id: string) {\r\n    const header = {\r\n      headers: new HttpHeaders({\r\n        'Content-Type': 'application/json',\r\n        'x-token': JSON.parse(localStorage.getItem('user')!).token\r\n      })\r\n    };\r\n\r\n    return this.httpPedirCita.get<interfaces.FetchCitasResponse>(this.pedirCitaUrl\r\n      + '/getcitapendienteuser/' + id, header).pipe(tap(resp => {this._citasPendientesUser = resp.citas;}));\r\n  }\r\n\r\n  \r\n  fetchCitasPasadas(id: string) {\r\n    const header = {\r\n      headers: new HttpHeaders({\r\n        'Content-Type': 'application/json',\r\n        'x-token': JSON.parse(localStorage.getItem('user')!).token\r\n      })\r\n    };\r\n\r\n    return this.httpPedirCita.get<interfaces.FetchCitasResponse>(this.pedirCitaUrl\r\n      + '/getcitaspasadasuser/' + id, header).pipe(tap(resp => {this._citasPasadasUser = resp.citas;}));\r\n  }\r\n\r\n  cancelarCita(id: string) {\r\n    const header = {\r\n      headers: new HttpHeaders({\r\n        'Content-Type': 'application/json',\r\n        'x-token': JSON.parse(localStorage.getItem('user')!).token\r\n      })\r\n    };\r\n\r\n    return this.httpPedirCita.put<interfaces.CancelarCitaResponse>(this.pedirCitaUrl\r\n      + '/cancelarcita/', {id: id}, header);\r\n  }\r\n\r\n  compHaPedidoCita(id: string) {\r\n    const header = {\r\n      headers: new HttpHeaders({\r\n        'Content-Type': 'application/json',\r\n        'x-token': JSON.parse(localStorage.getItem('user')!).token\r\n      })\r\n    };\r\n\r\n    return this.httpPedirCita.get<interfaces.CancelarCitaResponse>(this.pedirCitaUrl + \r\n      '/yatienecita/' + id, header);\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}