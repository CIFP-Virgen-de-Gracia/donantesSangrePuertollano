{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Alicia/Documents/Clase/DAW/Segundo/Desafio3_DonantesSangre/donantesSangrePuertollano/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { ModalPedirCitaComponent } from '../modal-pedir-cita/modal-pedir-cita.component';\nlet MenuComponent = class MenuComponent {\n  constructor(AuthService, SharedService, router, modal, citasService) {\n    this.AuthService = AuthService;\n    this.SharedService = SharedService;\n    this.router = router;\n    this.modal = modal;\n    this.citasService = citasService;\n    this.puedeModificar = false;\n    this.estaRegistrado = false;\n    this.puedePedirCita = true;\n  }\n  ngOnInit() {\n    const user = localStorage.getItem('user');\n    if (user) {\n      this.estaRegistrado = true;\n      this.comprobarPuedeModificar();\n    }\n    this.SharedService.comprobarPermisos.subscribe(registrado => {\n      this.estaRegistrado = registrado;\n      this.comprobarPuedeModificar();\n    });\n  }\n  comprobarPuedeModificar() {\n    if (this.estaRegistrado) {\n      this.AuthService.puedeModificar().subscribe(resp => {\n        this.puedeModificar = resp ? true : false;\n      });\n    }\n  }\n  ensenarModal() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      _this.modal.open(ModalPedirCitaComponent);\n    })();\n  }\n  // async ensenarModalPedirCita() {\n  //   if(this.estaRegistrado) {\n  //     const id = JSON.parse(localStorage.getItem('user')!).id\n  //     const resp = await lastValueFrom(this.citasService.compHaPedidoCita(id));\n  //     this.puedePedirCita = resp.success;\n  //   }\n  //   // this.modal.open(ModalPedirCitaComponent, this.estaRegistrado, this.puedePedirCita);\n  // }\n  //TODO: sacar cuadro preguntando\n  // ensenarModal() {\n  //   if (!this.estaRegistrado) this.modal.open(ModalPedirCitaComponent);\n  //   else this.router.navigate(['/citas/pedircita']);\n  // }\n  cerrarSesion() {\n    localStorage.removeItem('user');\n    this.estaRegistrado = false;\n    this.puedeModificar = false;\n    this.router.navigate(['']);\n  }\n};\nMenuComponent = __decorate([Component({\n  selector: 'app-menu',\n  templateUrl: './menu.component.html',\n  styleUrls: ['./menu.component.scss']\n})], MenuComponent);\nexport { MenuComponent };","map":{"version":3,"mappings":";;AAAA,SAASA,SAAS,QAAgB,eAAe;AAGjD,SAASC,uBAAuB,QAAQ,gDAAgD;AAYjF,IAAMC,aAAa,GAAnB,MAAMA,aAAa;EAMxBC,YACUC,WAAwB,EACxBC,aAA4B,EAC5BC,MAAc,EACdC,KAAe,EACfC,YAA0B;IAJ1B,gBAAW,GAAXJ,WAAW;IACX,kBAAa,GAAbC,aAAa;IACb,WAAM,GAANC,MAAM;IACN,UAAK,GAALC,KAAK;IACL,iBAAY,GAAZC,YAAY;IATtB,mBAAc,GAAY,KAAK;IAC/B,mBAAc,GAAY,KAAK;IAC/B,mBAAc,GAAY,IAAI;EAQ1B;EAIJC,QAAQ;IACN,MAAMC,IAAI,GAAGC,YAAY,CAACC,OAAO,CAAC,MAAM,CAAC;IAEzC,IAAIF,IAAI,EAAE;MACR,IAAI,CAACG,cAAc,GAAG,IAAI;MAE1B,IAAI,CAACC,uBAAuB,EAAE;;IAGhC,IAAI,CAACT,aAAa,CAACU,iBAAiB,CAACC,SAAS,CAACC,UAAU,IAAG;MAC1D,IAAI,CAACJ,cAAc,GAAGI,UAAU;MAEhC,IAAI,CAACH,uBAAuB,EAAE;IAChC,CAAC,CAAC;EACJ;EAGAA,uBAAuB;IACrB,IAAI,IAAI,CAACD,cAAc,EAAE;MACvB,IAAI,CAACT,WAAW,CAACc,cAAc,EAAE,CAACF,SAAS,CAACG,IAAI,IAAG;QACjD,IAAI,CAACD,cAAc,GAAIC,IAAI,GAAI,IAAI,GAAG,KAAK;MAC7C,CAAC,CAAC;;EAEN;EAEMC,YAAY;IAAA;IAAA;MAChB,KAAI,CAACb,KAAK,CAACc,IAAI,CAACpB,uBAAuB,CAAC;IAAC;EAC3C;EAEA;EAEA;EACA;EAEA;EAEA;EACA;EAEA;EACA;EAEA;EAEA;EACA;EACA;EACA;EAEAqB,YAAY;IACVX,YAAY,CAACY,UAAU,CAAC,MAAM,CAAC;IAC/B,IAAI,CAACV,cAAc,GAAG,KAAK;IAC3B,IAAI,CAACK,cAAc,GAAG,KAAK;IAC3B,IAAI,CAACZ,MAAM,CAACkB,QAAQ,CAAC,CAAC,EAAE,CAAC,CAAC;EAC5B;CAGD;AAzEYtB,aAAa,eALzBF,SAAS,CAAC;EACTyB,QAAQ,EAAE,UAAU;EACpBC,WAAW,EAAE,uBAAuB;EACpCC,SAAS,EAAE,CAAC,uBAAuB;CACpC,CAAC,GACWzB,aAAa,CAyEzB;SAzEYA,aAAa","names":["Component","ModalPedirCitaComponent","MenuComponent","constructor","AuthService","SharedService","router","modal","citasService","ngOnInit","user","localStorage","getItem","estaRegistrado","comprobarPuedeModificar","comprobarPermisos","subscribe","registrado","puedeModificar","resp","ensenarModal","open","cerrarSesion","removeItem","navigate","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["C:\\Users\\Alicia\\Documents\\Clase\\DAW\\Segundo\\Desafio3_DonantesSangre\\donantesSangrePuertollano\\front\\src\\app\\shared\\menu\\menu.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { Router } from '@angular/router';\r\nimport { NgbModal } from '@ng-bootstrap/ng-bootstrap';\r\nimport { ModalPedirCitaComponent } from '../modal-pedir-cita/modal-pedir-cita.component';\r\nimport { AuthService } from 'src/app/auth/services/auth.service';\r\nimport { SharedService } from '../services/shared.service';\r\nimport { CitasService } from 'src/app/citas/services/citas.service';\r\nimport { lastValueFrom } from 'rxjs';\r\nimport { PedirCitaModule } from 'src/app/citas/citas.module';\r\n\r\n@Component({\r\n  selector: 'app-menu',\r\n  templateUrl: './menu.component.html',\r\n  styleUrls: ['./menu.component.scss']\r\n})\r\nexport class MenuComponent implements OnInit {\r\n\r\n  puedeModificar: boolean = false;\r\n  estaRegistrado: boolean = false;\r\n  puedePedirCita: boolean = true;\r\n\r\n  constructor(\r\n    private AuthService: AuthService,\r\n    private SharedService: SharedService,\r\n    private router: Router,\r\n    private modal: NgbModal,\r\n    private citasService: CitasService\r\n  ) { }\r\n\r\n\r\n\r\n  ngOnInit() {\r\n    const user = localStorage.getItem('user');\r\n\r\n    if (user) {\r\n      this.estaRegistrado = true;\r\n\r\n      this.comprobarPuedeModificar();\r\n    }\r\n\r\n    this.SharedService.comprobarPermisos.subscribe(registrado => {\r\n      this.estaRegistrado = registrado;\r\n\r\n      this.comprobarPuedeModificar();\r\n    })\r\n  }\r\n\r\n\r\n  comprobarPuedeModificar() {\r\n    if (this.estaRegistrado) {\r\n      this.AuthService.puedeModificar().subscribe(resp => {\r\n        this.puedeModificar = (resp) ? true : false;\r\n      });\r\n    }\r\n  }\r\n\r\n  async ensenarModal() {\r\n    this.modal.open(ModalPedirCitaComponent);\r\n  }\r\n\r\n  // async ensenarModalPedirCita() {\r\n\r\n  //   if(this.estaRegistrado) {\r\n  //     const id = JSON.parse(localStorage.getItem('user')!).id\r\n\r\n  //     const resp = await lastValueFrom(this.citasService.compHaPedidoCita(id));\r\n\r\n  //     this.puedePedirCita = resp.success;\r\n  //   }\r\n\r\n  //   // this.modal.open(ModalPedirCitaComponent, this.estaRegistrado, this.puedePedirCita);\r\n  // }\r\n\r\n  //TODO: sacar cuadro preguntando\r\n\r\n  // ensenarModal() {\r\n  //   if (!this.estaRegistrado) this.modal.open(ModalPedirCitaComponent);\r\n  //   else this.router.navigate(['/citas/pedircita']);\r\n  // }\r\n\r\n  cerrarSesion() {\r\n    localStorage.removeItem('user');\r\n    this.estaRegistrado = false;\r\n    this.puedeModificar = false;\r\n    this.router.navigate(['']);\r\n  }\r\n\r\n\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}