{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Alicia/Documents/Clase/DAW/Segundo/Desafio3_DonantesSangre/donantesSangrePuertollano/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { EventEmitter } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/platform-browser\";\nimport * as i2 from \"../../services/config.service\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"@angular/common\";\nconst _c0 = [\"titulo\"];\nconst _c1 = [\"enunciado\"];\nconst _c2 = [\"respuesta_si\"];\nconst _c3 = [\"respuesta_no\"];\nconst _c4 = [\"recomendacion_problema\"];\nfunction AniadirPreguntaComponent_div_24_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 30);\n    i0.ɵɵelement(1, \"img\", 31);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", ctx_r2.previsualizacion, i0.ɵɵsanitizeUrl);\n  }\n}\nfunction AniadirPreguntaComponent_div_44_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 32)(1, \"p\");\n    i0.ɵɵtext(2, \"Es obligatorio a\\u00F1adir el titulo, el enunciado y la respuesta\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction AniadirPreguntaComponent_div_45_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 33)(1, \"p\");\n    i0.ɵɵtext(2, \"Pregunta ingresada correctamente\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction AniadirPreguntaComponent_div_46_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 32)(1, \"p\");\n    i0.ɵɵtext(2, \"Ha ocurrido un error al intentar ingresar la pregunta\");\n    i0.ɵɵelementEnd()();\n  }\n}\nexport class AniadirPreguntaComponent {\n  constructor(sanitizer, renderer2, config_Service) {\n    var _this = this;\n    this.sanitizer = sanitizer;\n    this.renderer2 = renderer2;\n    this.config_Service = config_Service;\n    this.previsualizacion = \"\";\n    this.archivos = [];\n    this.loading = false;\n    this.obligatorio = false;\n    this.qhp = 0;\n    this.pregunta = {\n      id: 0,\n      enunciado: \"\",\n      titulo: \"\",\n      nombre_img: \"\",\n      respuesta: 0,\n      solucion_problema: \"\"\n    };\n    this.recargarPreguntas = new EventEmitter();\n    this.extraerBase64 = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (event) {\n        return new Promise((resolve, reject) => {\n          try {\n            const unsafeImg = window.URL.createObjectURL(event);\n            const image = _this.sanitizer.bypassSecurityTrustUrl(unsafeImg);\n            const reader = new FileReader();\n            reader.readAsDataURL(event);\n            reader.onload = () => {\n              resolve({\n                base: reader.result\n              });\n            };\n            reader.onerror = error => {\n              resolve({\n                base: null\n              });\n            };\n            return reader;\n          } catch (err) {\n            return null;\n          }\n        });\n      });\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n  }\n  capturarFile(event) {\n    const archivoCapturado = event.target.files[0];\n    console.log(archivoCapturado.type);\n    if (archivoCapturado.type == 'image/jpg' || archivoCapturado.type == 'image/gif' || archivoCapturado.type == 'image/png' || archivoCapturado.type == 'image/jpeg' || archivoCapturado.type == 'image/tiff' || archivoCapturado.type == 'image/svg' || archivoCapturado.type == 'image/webp') {\n      this.extraerBase64(archivoCapturado).then(imagen => {\n        this.previsualizacion = imagen.base;\n      });\n      this.archivos.push(archivoCapturado);\n    }\n  }\n  subirFoto() {\n    try {\n      this.loading = true;\n      let formularioDeDatos = new FormData();\n      this.archivos.forEach(archivo => {\n        formularioDeDatos = new FormData();\n        formularioDeDatos.append('archivo', archivo);\n      });\n      if (this.archivos.length > 0) {\n        this.config_Service.subirFoto(formularioDeDatos).subscribe(res => {\n          this.loading = false;\n          console.log('Respuesta del servidor', res);\n          // this.recargarImagenes.emit();\n        });\n      }\n    } catch (e) {\n      this.loading = false;\n      console.log('ERROR', e);\n    }\n  }\n  ingresarPregunta() {\n    const titulo = this.titulo.nativeElement;\n    const enunciado = this.enunciado.nativeElement;\n    const si = this.respuesta_si.nativeElement;\n    const no = this.respuesta_no.nativeElement;\n    const solucion_problema = this.recomendacion.nativeElement;\n    this.renderer2.setAttribute(si, \"value\", \"1\");\n    this.renderer2.setAttribute(no, \"value\", \"0\");\n    if (titulo.value.trim() != \"\" && enunciado.value.trim() != \"\" && (!si.checked || !no.checked)) {\n      this.obligatorio = false;\n      this.pregunta.enunciado = enunciado.value;\n      this.pregunta.titulo = titulo.value;\n      if (this.archivos.length > 0) {\n        this.pregunta.nombre_img = this.archivos[this.archivos.length - 1];\n      }\n      if (si.checked) {\n        this.pregunta.respuesta = parseInt(si.value);\n      } else {\n        this.pregunta.respuesta = parseInt(no.value);\n      }\n      this.pregunta.solucion_problema = solucion_problema.value;\n      try {\n        this.loading = true;\n        this.config_Service.añadirPregunta(this.pregunta).subscribe(res => {\n          this.loading = false;\n          console.log('Respuesta del servidor', res);\n          this.qhp = 1;\n          this.recargarPreguntas.emit();\n        });\n      } catch (e) {\n        this.qhp = 2;\n      }\n    } else {\n      this.obligatorio = true;\n    }\n  }\n  cerrandoMensaje() {\n    this.obligatorio = false;\n    this.qhp = 0;\n  }\n}\nAniadirPreguntaComponent.ɵfac = function AniadirPreguntaComponent_Factory(t) {\n  return new (t || AniadirPreguntaComponent)(i0.ɵɵdirectiveInject(i1.DomSanitizer), i0.ɵɵdirectiveInject(i0.Renderer2), i0.ɵɵdirectiveInject(i2.ConfigService));\n};\nAniadirPreguntaComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AniadirPreguntaComponent,\n  selectors: [[\"app-aniadir-pregunta\"]],\n  viewQuery: function AniadirPreguntaComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n      i0.ɵɵviewQuery(_c1, 5);\n      i0.ɵɵviewQuery(_c2, 5);\n      i0.ɵɵviewQuery(_c3, 5);\n      i0.ɵɵviewQuery(_c4, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.titulo = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.enunciado = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.respuesta_si = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.respuesta_no = _t.first);\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.recomendacion = _t.first);\n    }\n  },\n  outputs: {\n    recargarPreguntas: \"recargarPreguntas\"\n  },\n  decls: 53,\n  vars: 6,\n  consts: [[\"id\", \"a\\u00F1adirPregunta\", \"data-bs-backdrop\", \"static\", \"data-bs-keyboard\", \"false\", \"tabindex\", \"-1\", \"aria-labelledby\", \"staticBackdropLabel\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\"], [1, \"modal-dialog\", \"modal-lg\"], [3, \"ngSubmit\"], [1, \"modal-content\"], [1, \"modal-header\", \"border-buttom\", \"border-danger\"], [\"id\", \"staticBackdropLabel\", 1, \"modal-title\", \"titulo\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", \"aria-label\", \"Close\", 1, \"btn-close\"], [1, \"modal-body\", \"border-buttom\", \"border-danger\"], [1, \"row\", \"d-flex\", \"justify-content-center\"], [1, \"col-12\"], [\"type\", \"text\", \"placeholder\", \"Escribe el titulo para esta pregunta\", 1, \"form-control\", \"mb-3\"], [\"titulo\", \"\"], [\"type\", \"text\", \"placeholder\", \"Escribe tu enunciado\", 1, \"form-control\", \"mb-3\"], [\"enunciado\", \"\"], [\"type\", \"file\", \"accept\", \"image/jpg,image/gif,image/png,image/jpeg,image/tiff,image/svg,image/webp\", 1, \"btn\", \"btn-light\", \"form-control\", \"border-3\", \"rounded-2\", \"mb-2\", 3, \"change\"], [\"class\", \"col-12 d-flex justify-content-center\", 4, \"ngIf\"], [1, \"form-check\"], [\"type\", \"radio\", \"name\", \"respuesta\", \"value\", \"1\", 1, \"form-check-input\"], [\"respuesta_si\", \"\"], [\"for\", \"si\", 1, \"form-check-label\"], [\"type\", \"radio\", \"name\", \"respuesta\", \"value\", \"0\", 1, \"form-check-input\"], [\"respuesta_no\", \"\"], [\"for\", \"no\", 1, \"form-check-label\"], [\"rows\", \"5\", \"placeholder\", \"Escribe tu recomendacion\", 1, \"form-control\", \"mb-3\"], [\"recomendacion_problema\", \"\"], [1, \"modal-footer\", \"d-flex\", \"justify-content-end\"], [\"class\", \"alert alert-danger w-100\", \"role\", \"alert\", 4, \"ngIf\"], [\"class\", \"alert alert-success w-100\", \"role\", \"alert\", 4, \"ngIf\"], [\"type\", \"submit\", 1, \"btn\", \"btn-secundario\", 3, \"disabled\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", 1, \"btn\", \"btn-secundario\", 3, \"click\"], [1, \"col-12\", \"d-flex\", \"justify-content-center\"], [1, \"w-50\", 3, \"src\"], [\"role\", \"alert\", 1, \"alert\", \"alert-danger\", \"w-100\"], [\"role\", \"alert\", 1, \"alert\", \"alert-success\", \"w-100\"]],\n  template: function AniadirPreguntaComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"form\", 2);\n      i0.ɵɵlistener(\"ngSubmit\", function AniadirPreguntaComponent_Template_form_ngSubmit_2_listener() {\n        return ctx.ingresarPregunta();\n      });\n      i0.ɵɵelementStart(3, \"div\", 3)(4, \"div\", 4)(5, \"h3\", 5);\n      i0.ɵɵtext(6, \"A\\u00F1adiendo una pregunta\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(7, \"button\", 6);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(8, \"div\", 7)(9, \"div\", 8)(10, \"div\", 9)(11, \"h4\");\n      i0.ɵɵtext(12, \"Titulo:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(13, \"input\", 10, 11);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(15, \"div\", 9)(16, \"h4\");\n      i0.ɵɵtext(17, \"Enunciado:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(18, \"input\", 12, 13);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"div\", 9)(21, \"h4\");\n      i0.ɵɵtext(22, \"Imagen:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(23, \"input\", 14);\n      i0.ɵɵlistener(\"change\", function AniadirPreguntaComponent_Template_input_change_23_listener($event) {\n        return ctx.capturarFile($event);\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(24, AniadirPreguntaComponent_div_24_Template, 2, 1, \"div\", 15);\n      i0.ɵɵelementStart(25, \"div\", 9)(26, \"h4\");\n      i0.ɵɵtext(27, \"Respuesta:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(28, \"div\", 16);\n      i0.ɵɵelement(29, \"input\", 17, 18);\n      i0.ɵɵelementStart(31, \"label\", 19);\n      i0.ɵɵtext(32, \"Si\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(33, \"div\", 16);\n      i0.ɵɵelement(34, \"input\", 20, 21);\n      i0.ɵɵelementStart(36, \"label\", 22);\n      i0.ɵɵtext(37, \"No\");\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(38, \"div\", 9)(39, \"h4\");\n      i0.ɵɵtext(40, \"Recomendaci\\u00F3nes a los problemas:\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(41, \"textarea\", 23, 24);\n      i0.ɵɵelementEnd()()();\n      i0.ɵɵelementStart(43, \"div\", 25);\n      i0.ɵɵtemplate(44, AniadirPreguntaComponent_div_44_Template, 3, 0, \"div\", 26);\n      i0.ɵɵtemplate(45, AniadirPreguntaComponent_div_45_Template, 3, 0, \"div\", 27);\n      i0.ɵɵtemplate(46, AniadirPreguntaComponent_div_46_Template, 3, 0, \"div\", 26);\n      i0.ɵɵelementStart(47, \"button\", 28)(48, \"span\");\n      i0.ɵɵtext(49);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(50, \"button\", 29);\n      i0.ɵɵlistener(\"click\", function AniadirPreguntaComponent_Template_button_click_50_listener() {\n        return ctx.cerrandoMensaje();\n      });\n      i0.ɵɵelementStart(51, \"span\");\n      i0.ɵɵtext(52, \"Cerrar\");\n      i0.ɵɵelementEnd()()()()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(24);\n      i0.ɵɵproperty(\"ngIf\", ctx.previsualizacion);\n      i0.ɵɵadvance(20);\n      i0.ɵɵproperty(\"ngIf\", ctx.obligatorio);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.qhp == 1);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngIf\", ctx.qhp == 2);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"disabled\", ctx.loading);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\" \", ctx.loading ? \"Cargando......\" : \"Guardar\", \" \");\n    }\n  },\n  dependencies: [i3.ɵNgNoValidate, i3.NgControlStatusGroup, i3.NgForm, i4.NgIf],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["EventEmitter","i0","AniadirPreguntaComponent","constructor","sanitizer","renderer2","config_Service","id","enunciado","titulo","nombre_img","respuesta","solucion_problema","event","Promise","resolve","reject","unsafeImg","window","URL","createObjectURL","image","bypassSecurityTrustUrl","reader","FileReader","readAsDataURL","onload","base","result","onerror","error","err","capturarFile","archivoCapturado","target","files","console","log","type","extraerBase64","then","imagen","previsualizacion","archivos","push","subirFoto","loading","formularioDeDatos","FormData","forEach","archivo","append","length","subscribe","res","e","ingresarPregunta","nativeElement","si","respuesta_si","no","respuesta_no","recomendacion","setAttribute","value","trim","checked","obligatorio","pregunta","parseInt","añadirPregunta","qhp","recargarPreguntas","emit","cerrandoMensaje","selectors","viewQuery","ctx"],"sourceRoot":"","sources":["C:\\Users\\Alicia\\Documents\\Clase\\DAW\\Segundo\\Desafio3_DonantesSangre\\donantesSangrePuertollano\\front\\src\\app\\config\\test-config\\aniadir-pregunta\\aniadir-pregunta.component.ts","C:\\Users\\Alicia\\Documents\\Clase\\DAW\\Segundo\\Desafio3_DonantesSangre\\donantesSangrePuertollano\\front\\src\\app\\config\\test-config\\aniadir-pregunta\\aniadir-pregunta.component.html"],"sourcesContent":["import { Component, ElementRef, EventEmitter, Output, ViewChild, Renderer2 } from '@angular/core';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\nimport { ConfigService } from '../../services/config.service';\r\nimport { Pregunta } from '../../../apto-sangre/interface/pregunta';\r\n\r\n@Component({\r\n  selector: 'app-aniadir-pregunta',\r\n  templateUrl: './aniadir-pregunta.component.html',\r\n  styleUrls: ['./aniadir-pregunta.component.scss']\r\n})\r\nexport class AniadirPreguntaComponent {\r\n\r\n  public filedata:any;\r\n  public previsualizacion: string = \"\";\r\n  public archivos:any = [];\r\n  public loading:boolean = false;\r\n\r\n  @ViewChild('titulo') titulo!: ElementRef<HTMLInputElement>;\r\n  @ViewChild('enunciado') enunciado!: ElementRef<HTMLInputElement>;\r\n  @ViewChild('respuesta_si') respuesta_si!: ElementRef<HTMLInputElement>;\r\n  @ViewChild('respuesta_no') respuesta_no!: ElementRef<HTMLInputElement>;\r\n  @ViewChild('recomendacion_problema') recomendacion!: ElementRef<HTMLInputElement>;\r\n  obligatorio : boolean = false;\r\n  qhp: number = 0;\r\n  pregunta: Pregunta = {\r\n    id: 0,\r\n    enunciado: \"\",\r\n    titulo: \"\",\r\n    nombre_img: \"\",\r\n    respuesta: 0,\r\n    solucion_problema: \"\"\r\n  }\r\n  @Output() recargarPreguntas = new EventEmitter();\r\n  constructor(private sanitizer: DomSanitizer, private renderer2: Renderer2,private config_Service: ConfigService) { }\r\n\r\n  capturarFile(event: any) {\r\n    const archivoCapturado = event.target.files[0];\r\n    console.log(archivoCapturado.type);\r\n    if(archivoCapturado.type == 'image/jpg' || archivoCapturado.type == 'image/gif' || archivoCapturado.type == 'image/png'\r\n    || archivoCapturado.type == 'image/jpeg' || archivoCapturado.type == 'image/tiff' || archivoCapturado.type == 'image/svg' || archivoCapturado.type == 'image/webp'){\r\n      this.extraerBase64(archivoCapturado).then((imagen: any)=> {\r\n        this.previsualizacion = imagen.base;\r\n      })\r\n      this.archivos.push(archivoCapturado);\r\n    }\r\n\r\n  }\r\n\r\n  extraerBase64 = async (event: any) => new Promise((resolve, reject) => {\r\n    try{\r\n      const unsafeImg = window.URL.createObjectURL(event);\r\n      const image = this.sanitizer.bypassSecurityTrustUrl(unsafeImg);\r\n      const reader = new FileReader();\r\n      reader.readAsDataURL(event);\r\n      reader.onload = () => {\r\n        resolve({\r\n          base: reader.result\r\n        });\r\n      };\r\n      reader.onerror = error => {\r\n        resolve({\r\n          base: null\r\n        });\r\n      };\r\n      return reader;\r\n    } catch (err) {\r\n      return null;\r\n    }\r\n  })\r\n\r\n  subirFoto(): any {\r\n    try{\r\n      this.loading = true;\r\n      let formularioDeDatos = new FormData();\r\n\r\n      this.archivos.forEach((archivo: File) => {\r\n        formularioDeDatos = new FormData();\r\n        formularioDeDatos.append('archivo', archivo);\r\n      })\r\n      if(this.archivos.length > 0){\r\n        this.config_Service.subirFoto(formularioDeDatos)\r\n        .subscribe((res) => {\r\n\r\n          this.loading = false;\r\n          console.log('Respuesta del servidor', res);\r\n          // this.recargarImagenes.emit();\r\n\r\n        })\r\n      }\r\n\r\n    } catch (e) {\r\n      this.loading = false;\r\n      console.log('ERROR', e);\r\n    }\r\n  }\r\n\r\n  ingresarPregunta() {\r\n    const titulo = this.titulo.nativeElement;\r\n    const enunciado = this.enunciado.nativeElement;\r\n    const si = this.respuesta_si.nativeElement;\r\n    const no = this.respuesta_no.nativeElement;\r\n    const solucion_problema = this.recomendacion.nativeElement;\r\n    this.renderer2.setAttribute(si,\"value\", \"1\");\r\n    this.renderer2.setAttribute(no,\"value\", \"0\");\r\n\r\n    if(titulo.value.trim() != \"\" &&  enunciado.value.trim() != \"\" &&  (!si.checked || !no.checked)){\r\n      this.obligatorio = false;\r\n      this.pregunta.enunciado = enunciado.value;\r\n      this.pregunta.titulo = titulo.value\r\n      if(this.archivos.length > 0){\r\n        this.pregunta.nombre_img = this.archivos[this.archivos.length - 1];\r\n      }\r\n      if(si.checked){\r\n        this.pregunta.respuesta = parseInt(si.value);\r\n      }\r\n      else{\r\n        this.pregunta.respuesta = parseInt(no.value);\r\n      }\r\n      this.pregunta.solucion_problema = solucion_problema.value;\r\n\r\n      try{\r\n        this.loading = true;\r\n        this.config_Service.añadirPregunta(this.pregunta).subscribe((res) => {\r\n          this.loading = false;\r\n          console.log('Respuesta del servidor', res);\r\n          this.qhp = 1;\r\n          this.recargarPreguntas.emit();\r\n\r\n        });\r\n      }\r\n      catch(e){\r\n        this.qhp = 2;\r\n      }\r\n\r\n\r\n    }\r\n    else{\r\n      this.obligatorio = true;\r\n    }\r\n  }\r\n\r\n  cerrandoMensaje(){\r\n    this.obligatorio = false;\r\n    this.qhp = 0;\r\n  }\r\n}\r\n","<div class=\"modal fade\" id=\"añadirPregunta\" data-bs-backdrop=\"static\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog modal-lg\">\r\n    <form (ngSubmit)=\"ingresarPregunta()\">\r\n      <div class=\"modal-content\">\r\n        <div class=\"modal-header border-buttom border-danger\">\r\n          <h3 class=\"modal-title titulo\" id=\"staticBackdropLabel\">Añadiendo una pregunta</h3>\r\n          <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n        </div>\r\n        <div class=\"modal-body border-buttom border-danger\">\r\n          <div class=\"row d-flex justify-content-center\">\r\n            <div class=\"col-12\">\r\n              <h4>Titulo:</h4>\r\n              <input #titulo type=\"text\" class=\"form-control mb-3\" placeholder=\"Escribe el titulo para esta pregunta\">\r\n            </div>\r\n            <div class=\"col-12\">\r\n              <h4>Enunciado:</h4>\r\n              <input #enunciado type=\"text\" class=\"form-control mb-3\" placeholder=\"Escribe tu enunciado\">\r\n            </div>\r\n            <div class=\"col-12\">\r\n              <h4>Imagen:</h4>\r\n              <input (change)=\"capturarFile($event)\" type=\"file\" class=\"btn btn-light form-control border-3 rounded-2 mb-2\" accept=\"image/jpg,image/gif,image/png,image/jpeg,image/tiff,image/svg,image/webp\">\r\n\r\n            </div>\r\n            <div *ngIf=\"previsualizacion\" class=\"col-12 d-flex justify-content-center\">\r\n              <img [src]=\"previsualizacion\" class=\"w-50\">\r\n            </div>\r\n            <div class=\"col-12\">\r\n              <h4>Respuesta:</h4>\r\n                <div class=\"form-check\">\r\n                  <input #respuesta_si type=\"radio\" class=\"form-check-input\" name=\"respuesta\" value=\"1\">\r\n                  <label class=\"form-check-label\" for=\"si\">Si</label>\r\n                </div>\r\n                <div class=\"form-check\">\r\n                  <input #respuesta_no type=\"radio\" class=\"form-check-input\" name=\"respuesta\" value=\"0\">\r\n                  <label class=\"form-check-label\" for=\"no\">No</label>\r\n                </div>\r\n            </div>\r\n            <div class=\"col-12\">\r\n              <h4>Recomendaciónes a los problemas:</h4>\r\n              <textarea #recomendacion_problema class=\"form-control mb-3\" rows=\"5\" placeholder=\"Escribe tu recomendacion\"></textarea>\r\n            </div>\r\n\r\n          </div>\r\n        </div>\r\n        <div class=\"modal-footer d-flex justify-content-end\">\r\n            <div *ngIf=\"obligatorio\" class=\"alert alert-danger w-100\" role=\"alert\">\r\n              <p>Es obligatorio añadir el titulo, el enunciado y la respuesta</p>\r\n            </div>\r\n            <div *ngIf=\"qhp == 1\" class=\"alert alert-success w-100\" role=\"alert\">\r\n              <p>Pregunta ingresada correctamente</p>\r\n            </div>\r\n            <div *ngIf=\"qhp == 2\" class=\"alert alert-danger w-100\" role=\"alert\">\r\n              <p>Ha ocurrido un error al intentar ingresar la pregunta</p>\r\n            </div>\r\n            <button type=\"submit\" class=\"btn btn-secundario\" [disabled]=\"loading\">\r\n              <span>\r\n                {{(loading) ? 'Cargando......' : 'Guardar'}}\r\n              </span>\r\n            </button>\r\n            <button (click)=\"cerrandoMensaje()\" type=\"button\" class=\"btn btn-secundario\" data-bs-dismiss=\"modal\"><span>Cerrar</span></button>\r\n        </div>\r\n      </div>\r\n    </form>\r\n  </div>\r\n</div>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}