{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/Alicia/Documents/Clase/DAW/Segundo/Desafio3_DonantesSangre/donantesSangrePuertollano/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { EventEmitter } from '@angular/core';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/platform-browser\";\nimport * as i2 from \"../service/galeria.service\";\nimport * as i3 from \"@angular/common\";\nfunction AddImagenComponent_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 8);\n    i0.ɵɵelement(1, \"img\", 14);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", ctx_r0.previsualizacion, i0.ɵɵsanitizeUrl);\n  }\n}\nexport class AddImagenComponent {\n  constructor(sanitizer, galeriaServicio) {\n    var _this = this;\n    this.sanitizer = sanitizer;\n    this.galeriaServicio = galeriaServicio;\n    this.previsualizacion = \"\";\n    this.archivos = [];\n    this.loading = false;\n    this.recargarImagenes = new EventEmitter();\n    this.extraerBase64 = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (event) {\n        return new Promise((resolve, reject) => {\n          try {\n            const unsafeImg = window.URL.createObjectURL(event);\n            const image = _this.sanitizer.bypassSecurityTrustUrl(unsafeImg);\n            const reader = new FileReader();\n            reader.readAsDataURL(event);\n            reader.onload = () => {\n              resolve({\n                base: reader.result\n              });\n            };\n            reader.onerror = error => {\n              resolve({\n                base: null\n              });\n            };\n            return reader;\n          } catch (err) {\n            return null;\n          }\n        });\n      });\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }();\n  }\n  ngOnInit() {}\n  capturarFile(event) {\n    const archivoCapturado = event.target.files[0];\n    if (archivoCapturado.type == 'image/jpg' || archivoCapturado.type == 'image/gif' || archivoCapturado.type == 'image/png' || archivoCapturado.type == 'image/jpeg' || archivoCapturado.type == 'image/tiff' || archivoCapturado.type == 'image/svg' || archivoCapturado.type == 'image/webp') {\n      this.extraerBase64(archivoCapturado).then(imagen => {\n        this.previsualizacion = imagen.base;\n      });\n      this.archivos.push(archivoCapturado);\n    }\n  }\n  subirFoto() {\n    try {\n      this.loading = true;\n      let formularioDeDatos = new FormData();\n      this.archivos.forEach(archivo => {\n        formularioDeDatos = new FormData();\n        formularioDeDatos.append('archivo', archivo);\n      });\n      if (this.archivos.length > 0) {\n        this.galeriaServicio.subirFoto(formularioDeDatos).subscribe(res => {\n          this.loading = false;\n          this.recargarImagenes.emit();\n        });\n      }\n    } catch (e) {\n      this.loading = false;\n    }\n  }\n}\nAddImagenComponent.ɵfac = function AddImagenComponent_Factory(t) {\n  return new (t || AddImagenComponent)(i0.ɵɵdirectiveInject(i1.DomSanitizer), i0.ɵɵdirectiveInject(i2.GaleriaService));\n};\nAddImagenComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: AddImagenComponent,\n  selectors: [[\"app-add-imagen\"]],\n  outputs: {\n    recargarImagenes: \"recargarImagenes\"\n  },\n  decls: 19,\n  vars: 3,\n  consts: [[\"id\", \"modalSubirFoto\", \"data-bs-backdrop\", \"static\", \"data-bs-keyboard\", \"false\", \"tabindex\", \"-1\", \"aria-labelledby\", \"staticBackdropLabel\", \"aria-hidden\", \"true\", 1, \"modal\", \"fade\"], [1, \"modal-dialog\"], [1, \"modal-content\"], [1, \"modal-header\"], [\"id\", \"staticBackdropLabel\", 1, \"modal-title\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", \"aria-label\", \"Close\", 1, \"btn-close\"], [1, \"modal-body\"], [1, \"row\"], [1, \"col-12\", \"d-flex\", \"justify-content-center\"], [\"type\", \"file\", \"accept\", \"image/jpg,image/gif,image/png,image/jpeg,image/tiff,image/svg,image/webp\", 1, \"btn\", \"btn-light\", \"form-control\", \"border-3\", \"rounded-2\", \"mb-2\", 3, \"change\"], [\"class\", \"col-12 d-flex justify-content-center\", 4, \"ngIf\"], [1, \"modal-footer\", \"d-flex\", \"justify-content-end\"], [\"type\", \"button\", 1, \"btn\", \"btn-primary\", 3, \"disabled\", \"click\"], [\"type\", \"button\", \"data-bs-dismiss\", \"modal\", 1, \"btn\", \"btn-secundario\"], [1, \"w-50\", 3, \"src\"]],\n  template: function AddImagenComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"h5\", 4);\n      i0.ɵɵtext(5, \"Subir Foto\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelement(6, \"button\", 5);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(7, \"div\", 6)(8, \"div\", 7)(9, \"div\", 8)(10, \"input\", 9);\n      i0.ɵɵlistener(\"change\", function AddImagenComponent_Template_input_change_10_listener($event) {\n        return ctx.capturarFile($event);\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵtemplate(11, AddImagenComponent_div_11_Template, 2, 1, \"div\", 10);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(12, \"div\", 11)(13, \"button\", 12);\n      i0.ɵɵlistener(\"click\", function AddImagenComponent_Template_button_click_13_listener() {\n        return ctx.subirFoto();\n      });\n      i0.ɵɵelementStart(14, \"span\");\n      i0.ɵɵtext(15);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(16, \"button\", 13)(17, \"span\");\n      i0.ɵɵtext(18, \"Cerrar\");\n      i0.ɵɵelementEnd()()()()()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(11);\n      i0.ɵɵproperty(\"ngIf\", ctx.previsualizacion);\n      i0.ɵɵadvance(2);\n      i0.ɵɵproperty(\"disabled\", ctx.loading);\n      i0.ɵɵadvance(2);\n      i0.ɵɵtextInterpolate1(\" \", ctx.loading ? \"Cargando......\" : \"Subir Imagen\", \" \");\n    }\n  },\n  dependencies: [i3.NgIf],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["EventEmitter","i0","AddImagenComponent","constructor","sanitizer","galeriaServicio","event","Promise","resolve","reject","unsafeImg","window","URL","createObjectURL","image","bypassSecurityTrustUrl","reader","FileReader","readAsDataURL","onload","base","result","onerror","error","err","ngOnInit","capturarFile","archivoCapturado","target","files","type","extraerBase64","then","imagen","previsualizacion","archivos","push","subirFoto","loading","formularioDeDatos","FormData","forEach","archivo","append","length","subscribe","res","recargarImagenes","emit","e","selectors","outputs","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\Alicia\\Documents\\Clase\\DAW\\Segundo\\Desafio3_DonantesSangre\\donantesSangrePuertollano\\front\\src\\app\\galeria\\add-imagen\\add-imagen.component.ts","C:\\Users\\Alicia\\Documents\\Clase\\DAW\\Segundo\\Desafio3_DonantesSangre\\donantesSangrePuertollano\\front\\src\\app\\galeria\\add-imagen\\add-imagen.component.html"],"sourcesContent":["import { HttpRequest } from '@angular/common/http';\r\nimport { Component, EventEmitter, OnInit, Output } from '@angular/core';\r\nimport { DomSanitizer } from '@angular/platform-browser';\r\nimport { GaleriaService } from '../service/galeria.service';\r\n\r\n@Component({\r\n  selector: 'app-add-imagen',\r\n  templateUrl: './add-imagen.component.html',\r\n  styleUrls: ['./add-imagen.component.scss']\r\n})\r\nexport class AddImagenComponent implements OnInit{\r\n  public filedata:any;\r\n  public previsualizacion: string = \"\";\r\n  public archivos:any = [];\r\n  public loading:boolean = false;\r\n  @Output() recargarImagenes = new EventEmitter();\r\n  constructor(private sanitizer: DomSanitizer, public galeriaServicio: GaleriaService) { }\r\n\r\n  ngOnInit(): void {\r\n\r\n  }\r\n  capturarFile(event: any) {\r\n    const archivoCapturado = event.target.files[0];\r\n    if(archivoCapturado.type == 'image/jpg' || archivoCapturado.type == 'image/gif' || archivoCapturado.type == 'image/png'\r\n    || archivoCapturado.type == 'image/jpeg' || archivoCapturado.type == 'image/tiff' || archivoCapturado.type == 'image/svg' || archivoCapturado.type == 'image/webp'){\r\n      this.extraerBase64(archivoCapturado).then((imagen: any)=> {\r\n        this.previsualizacion = imagen.base;\r\n      })\r\n      this.archivos.push(archivoCapturado);\r\n    }\r\n\r\n  }\r\n\r\n  extraerBase64 = async (event: any) => new Promise((resolve, reject) => {\r\n    try{\r\n      const unsafeImg = window.URL.createObjectURL(event);\r\n      const image = this.sanitizer.bypassSecurityTrustUrl(unsafeImg);\r\n      const reader = new FileReader();\r\n      reader.readAsDataURL(event);\r\n      reader.onload = () => {\r\n        resolve({\r\n          base: reader.result\r\n        });\r\n      };\r\n      reader.onerror = error => {\r\n        resolve({\r\n          base: null\r\n        });\r\n      };\r\n      return reader;\r\n    } catch (err) {\r\n      return null;\r\n    }\r\n  })\r\n\r\n  subirFoto(): any {\r\n    try{\r\n      this.loading = true;\r\n      let formularioDeDatos = new FormData();\r\n\r\n      this.archivos.forEach((archivo: File) => {\r\n        formularioDeDatos = new FormData();\r\n        formularioDeDatos.append('archivo', archivo);\r\n      })\r\n      if(this.archivos.length > 0){\r\n        this.galeriaServicio.subirFoto(formularioDeDatos)\r\n        .subscribe((res) => {\r\n\r\n          this.loading = false;\r\n          this.recargarImagenes.emit();\r\n\r\n        })\r\n      }\r\n\r\n    } catch (e) {\r\n      this.loading = false;\r\n    }\r\n  }\r\n}\r\n","<div class=\"modal fade\" id=\"modalSubirFoto\" data-bs-backdrop=\"static\" data-bs-keyboard=\"false\" tabindex=\"-1\" aria-labelledby=\"staticBackdropLabel\" aria-hidden=\"true\">\r\n  <div class=\"modal-dialog\">\r\n    <div class=\"modal-content\">\r\n      <div class=\"modal-header\">\r\n        <h5 class=\"modal-title\" id=\"staticBackdropLabel\">Subir Foto</h5>\r\n        <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\r\n      </div>\r\n      <div class=\"modal-body\">\r\n        <div class=\"row\">\r\n          <div class=\"col-12 d-flex justify-content-center\">\r\n            <input (change)=\"capturarFile($event)\" type=\"file\" class=\"btn btn-light form-control border-3 rounded-2 mb-2\" accept=\"image/jpg,image/gif,image/png,image/jpeg,image/tiff,image/svg,image/webp\">\r\n          </div>\r\n          <div *ngIf=\"previsualizacion\" class=\"col-12 d-flex justify-content-center\">\r\n            <img [src]=\"previsualizacion\" class=\"w-50\">\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n      <div class=\"modal-footer d-flex justify-content-end\">\r\n          <button type=\"button\" class=\"btn btn-primary\" [disabled]=\"loading\" (click)=\"subirFoto()\">\r\n            <span>\r\n              {{(loading) ? 'Cargando......' : 'Subir Imagen'}}\r\n            </span>\r\n          </button>\r\n          <button type=\"button\" class=\"btn btn-secundario\" data-bs-dismiss=\"modal\"><span>Cerrar</span></button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}