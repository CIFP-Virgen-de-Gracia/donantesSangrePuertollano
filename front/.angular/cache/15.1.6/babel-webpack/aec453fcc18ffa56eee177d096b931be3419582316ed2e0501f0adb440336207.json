{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/citas.service\";\nimport * as i2 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"src/app/shared/services/shared.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@angular/forms\";\nimport * as i7 from \"../date-picker/date-picker.component\";\nfunction PedirCitaPacienteComponent_option_17_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 14);\n    i0.ɵɵtext(1, \"Selecciona una hora\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PedirCitaPacienteComponent_option_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\");\n    i0.ɵɵtext(1, \" No hay horas disponibles \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PedirCitaPacienteComponent_option_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 24);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const hora_r3 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", hora_r3);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", hora_r3, \" \");\n  }\n}\nexport class PedirCitaPacienteComponent {\n  constructor(pedirCitaHttpService, calendar, router, sharedService) {\n    this.pedirCitaHttpService = pedirCitaHttpService;\n    this.calendar = calendar;\n    this.router = router;\n    this.sharedService = sharedService;\n    this.onCitaPedida = new EventEmitter();\n    this.sinSeleccionar = true;\n    this.registrado = false;\n    this.noHayHoras = false;\n    this.horasDisponibles = [];\n    this.citaPedida = -1;\n    this.citaForm = new FormGroup({\n      hora: new FormControl('', [Validators.required]),\n      donacion: new FormControl('sangre', [Validators.required])\n    });\n  }\n  ngOnInit() {\n    this.sinSeleccionar = true;\n    this.fecha = this.calendar.getToday();\n    this.transFecha(this.fecha);\n    this.compRegistro();\n  }\n  compRegistro() {\n    this.registrado = localStorage.getItem('user') != null;\n    console.log(this.registrado);\n  }\n  transFecha(fechaCalendar) {\n    console.log('fecha');\n    console.log(this.fecha);\n    this.fechaSeleccionada = this.fecha.year + '-' + this.fecha.month + '-' + this.fecha.day;\n  }\n  traerHorario() {\n    this.pedirCitaHttpService.fetchHorasDisponibles(this.fechaSeleccionada).subscribe(resp => {\n      this.horasDisponibles = resp.horas;\n      console.log(this.horasDisponibles);\n      if (this.horasDisponibles.length == 0) this.noHayHoras = true;\n    });\n  }\n  setDia(event) {\n    this.fecha = event;\n    this.transFecha(this.fecha);\n    this.traerHorario();\n    this.sinSeleccionar = false;\n  }\n  pedirCita() {\n    const id = JSON.parse(localStorage.getItem('user') || '{}').id;\n    console.log(id);\n    const fechaCita = this.fechaSeleccionada + ' ' + this.citaForm.get('hora')?.value + ':00';\n    const tipoDonacion = this.citaForm.get('donacion')?.value;\n    this.pedirCitaHttpService.insertCita(id, fechaCita, tipoDonacion).subscribe(resp => {\n      if (resp.success) {\n        console.log('asdfasdfasdfasdf');\n        // this.onCitaPedida.emit(true);\n        this.sharedService.citaPedida.next(0);\n        this.sharedService.citaPedida.complete();\n      } else {\n        this.sharedService.citaPedida.next(1);\n      }\n      this.router.navigate(['']);\n    });\n  }\n}\nPedirCitaPacienteComponent.ɵfac = function PedirCitaPacienteComponent_Factory(t) {\n  return new (t || PedirCitaPacienteComponent)(i0.ɵɵdirectiveInject(i1.CitasService), i0.ɵɵdirectiveInject(i2.NgbCalendar), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.SharedService));\n};\nPedirCitaPacienteComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: PedirCitaPacienteComponent,\n  selectors: [[\"app-pedir-cita-paciente\"]],\n  outputs: {\n    onCitaPedida: \"onCitaPedida\"\n  },\n  decls: 34,\n  vars: 5,\n  consts: [[1, \"container-fluid\", \"fondo\", \"px-2\", \"py-5\", \"p-md-5\"], [1, \"row\"], [1, \"col-0\", \"col-sm-1\", \"col-lg-2\"], [1, \"col-12\", \"col-sm-10\", \"col-lg-8\", \"contenedor\"], [1, \"card\", \"border-0\", \"rounded-0\", \"w-100\", \"mb-0\"], [1, \"card-header\", \"d-flex\", \"justify-content-center\", \"align-items-center\", \"py-1\", \"border-bottom-0\"], [1, \"card-body\", \"p-5\", \"mt-5\"], [3, \"formGroup\", \"ngSubmit\"], [1, \"col-12\", \"col-md-6\", \"d-flex\", \"justify-content-center\", \"mb-4\", \"mb-md-0\"], [3, \"onNuevaFecha\"], [1, \"col-12\", \"col-md-6\"], [1, \"col-12\"], [\"formControlName\", \"hora\", \"name\", \"hora\", 1, \"form-select\", \"form-select-sm\", \"mb-3\"], [\"value\", \"\", \"disabled\", \"\", \"selected\", \"\", \"hidden\", \"\", 4, \"ngIf\"], [\"value\", \"\", \"disabled\", \"\", \"selected\", \"\", \"hidden\", \"\"], [4, \"ngIf\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"formControlName\", \"donacion\", \"name\", \"donacion\", 1, \"form-select\", \"form-select-sm\"], [\"value\", \"sangre\", \"selected\", \"\"], [\"value\", \"plasma\"], [1, \"card-body\", \"p-0\", \"mt-5\"], [\"type\", \"submit\", 1, \"btn\", \"w-100\", \"btnAceptar\", \"mb-3\", 3, \"disabled\"], [\"type\", \"button\", 1, \"btn\", \"w-100\", \"border-red\"], [1, \"col-0\", \"col-sm-1\", \"col-lg-3\"], [3, \"value\"]],\n  template: function PedirCitaPacienteComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n      i0.ɵɵelement(2, \"div\", 2);\n      i0.ɵɵelementStart(3, \"div\", 3)(4, \"div\", 4)(5, \"div\", 5)(6, \"h1\");\n      i0.ɵɵtext(7, \"Pedir cita\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(8, \"div\", 6)(9, \"form\", 7);\n      i0.ɵɵlistener(\"ngSubmit\", function PedirCitaPacienteComponent_Template_form_ngSubmit_9_listener() {\n        return ctx.pedirCita();\n      });\n      i0.ɵɵelementStart(10, \"div\", 1)(11, \"div\", 8)(12, \"app-date-picker\", 9);\n      i0.ɵɵlistener(\"onNuevaFecha\", function PedirCitaPacienteComponent_Template_app_date_picker_onNuevaFecha_12_listener($event) {\n        return ctx.setDia($event);\n      });\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(13, \"div\", 10)(14, \"div\", 1)(15, \"div\", 11)(16, \"select\", 12);\n      i0.ɵɵtemplate(17, PedirCitaPacienteComponent_option_17_Template, 2, 0, \"option\", 13);\n      i0.ɵɵelementStart(18, \"option\", 14);\n      i0.ɵɵtext(19, \"Horas disponibles\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵtemplate(20, PedirCitaPacienteComponent_option_20_Template, 2, 0, \"option\", 15);\n      i0.ɵɵtemplate(21, PedirCitaPacienteComponent_option_21_Template, 2, 2, \"option\", 16);\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(22, \"div\", 11)(23, \"select\", 17)(24, \"option\", 18);\n      i0.ɵɵtext(25, \"Sangre\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(26, \"option\", 19);\n      i0.ɵɵtext(27, \"Plasma\");\n      i0.ɵɵelementEnd()()()()()();\n      i0.ɵɵelementStart(28, \"div\", 20)(29, \"button\", 21);\n      i0.ɵɵtext(30, \"Aceptar\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(31, \"button\", 22);\n      i0.ɵɵtext(32, \"Cancelar\");\n      i0.ɵɵelementEnd()()()()()();\n      i0.ɵɵelement(33, \"div\", 23);\n      i0.ɵɵelementEnd()();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(9);\n      i0.ɵɵproperty(\"formGroup\", ctx.citaForm);\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"ngIf\", ctx.sinSeleccionar);\n      i0.ɵɵadvance(3);\n      i0.ɵɵproperty(\"ngIf\", ctx.noHayHoras);\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"ngForOf\", ctx.horasDisponibles);\n      i0.ɵɵadvance(8);\n      i0.ɵɵproperty(\"disabled\", ctx.citaForm.invalid);\n    }\n  },\n  dependencies: [i5.NgForOf, i5.NgIf, i6.ɵNgNoValidate, i6.NgSelectOption, i6.ɵNgSelectMultipleOption, i6.SelectControlValueAccessor, i6.NgControlStatus, i6.NgControlStatusGroup, i6.FormGroupDirective, i6.FormControlName, i7.DatePickerComponent],\n  styles: [\"div.alert[_ngcontent-%COMP%] {\\n  z-index: 9000;\\n  width: 25rem;\\n}\\ndiv.alert[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\\n  text-decoration: none;\\n  color: rgb(9, 43, 9);\\n}\\ndiv.alert[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover {\\n  color: rgb(2, 51, 2);\\n}\\n\\ndiv.container-fluid[_ngcontent-%COMP%] {\\n  background-color: var(--color-contraste);\\n  min-height: 80vh;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%] {\\n  box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-header[_ngcontent-%COMP%] {\\n  background-color: var(--color-primario);\\n  color: var(--bs-white);\\n  height: 9rem;\\n  border-radius: 2px 2px 0px 0px;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%] {\\n  margin-bottom: 2.5rem;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   div.calendario[_ngcontent-%COMP%] {\\n  height: 15rem;\\n  width: 20rem;\\n  background-color: green;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n  border-radius: 2px;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   button.btnAceptar[_ngcontent-%COMP%] {\\n  background-color: var(--color-secundario);\\n  color: var(--bs-white);\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   button.btnAceptar[_ngcontent-%COMP%]:hover {\\n  border: solid 1px var(--color-primario);\\n  background-color: var(--color-primario);\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   button.border-red[_ngcontent-%COMP%] {\\n  border: solid 1px var(--color-secundario);\\n  color: var(--color-secundario);\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   button.border-red[_ngcontent-%COMP%]:hover {\\n  background-color: var(--color-contraste);\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY2l0YXMvcGVkaXItY2l0YS1wYWNpZW50ZS9wZWRpci1jaXRhLXBhY2llbnRlLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksYUFBQTtFQUNBLFlBQUE7QUFDSjtBQUNJO0VBQ0kscUJBQUE7RUFDQSxvQkFBQTtBQUNSO0FBQ1E7RUFDSSxvQkFBQTtBQUNaOztBQUlBO0VBQ0ksd0NBQUE7RUFDQSxnQkFBQTtBQURKO0FBR0k7RUFDSSx3Q0FBQTtBQURSO0FBS1E7RUFDSSx1Q0FBQTtFQUNBLHNCQUFBO0VBQ0EsWUFBQTtFQUVBLDhCQUFBO0FBSlo7QUFRUTtFQUNJLHFCQUFBO0FBTlo7QUFRWTtFQUNJLGFBQUE7RUFDQSxZQUFBO0VBQ0EsdUJBQUE7QUFOaEI7QUFTWTtFQXFCSSxrQkFBQTtBQTNCaEI7QUFPZ0I7RUFDSSx5Q0FBQTtFQUNBLHNCQUFBO0FBTHBCO0FBT29CO0VBQ0ksdUNBQUE7RUFDQSx1Q0FBQTtBQUx4QjtBQVNnQjtFQUNJLHlDQUFBO0VBQ0EsOEJBQUE7QUFQcEI7QUFTb0I7RUFDSSx3Q0FBQTtBQVB4QiIsInNvdXJjZXNDb250ZW50IjpbImRpdi5hbGVydCB7XG4gICAgei1pbmRleDogOTAwMDtcbiAgICB3aWR0aDogMjVyZW07XG5cbiAgICBhIHtcbiAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xuICAgICAgICBjb2xvcjogcmdiKDksIDQzLCA5KTtcblxuICAgICAgICAmOmhvdmVyIHtcbiAgICAgICAgICAgIGNvbG9yOiByZ2IoMiwgNTEsIDIpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5kaXYuY29udGFpbmVyLWZsdWlkIHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jb2xvci1jb250cmFzdGUpO1xuICAgIG1pbi1oZWlnaHQ6IDgwdmg7XG5cbiAgICBkaXYuY2FyZCB7XG4gICAgICAgIGJveC1zaGFkb3c6IDAgM3B4IDlweCByZ2JhKDAsIDAsIDAsIC41KTtcbiAgICAgICAgLy8gd2lkdGg6IDQwdnc7XG5cbiAgICAgICAgXG4gICAgICAgIGRpdi5jYXJkLWhlYWRlciB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jb2xvci1wcmltYXJpbyk7XG4gICAgICAgICAgICBjb2xvcjogdmFyKC0tYnMtd2hpdGUpO1xuICAgICAgICAgICAgaGVpZ2h0OiA5cmVtO1xuXG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiAycHggMnB4IDBweCAwcHg7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGRpdi5jYXJkLWJvZHkge1xuICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMi41cmVtO1xuXG4gICAgICAgICAgICBkaXYuY2FsZW5kYXJpbyB7XG4gICAgICAgICAgICAgICAgaGVpZ2h0OiAxNXJlbTtcbiAgICAgICAgICAgICAgICB3aWR0aDogMjByZW07XG4gICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogZ3JlZW47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGJ1dHRvbiB7XG4gICAgICAgICAgICAgICAgJi5idG5BY2VwdGFyIHtcbiAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3Itc2VjdW5kYXJpbyk7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1icy13aGl0ZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgJjpob3ZlciB7XG4gICAgICAgICAgICAgICAgICAgICAgICBib3JkZXI6IHNvbGlkIDFweCB2YXIoLS1jb2xvci1wcmltYXJpbyk7IFxuICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3ItcHJpbWFyaW8pO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICYuYm9yZGVyLXJlZCB7ICAgIFxuICAgICAgICAgICAgICAgICAgICBib3JkZXI6IHNvbGlkIDFweCB2YXIoLS1jb2xvci1zZWN1bmRhcmlvKTsgIFxuICAgICAgICAgICAgICAgICAgICBjb2xvcjogdmFyKC0tY29sb3Itc2VjdW5kYXJpbyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgJjpob3ZlciB7XG4gICAgICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jb2xvci1jb250cmFzdGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiAycHg7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59ICAgIFxuXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["EventEmitter","FormControl","FormGroup","Validators","i0","PedirCitaPacienteComponent","constructor","pedirCitaHttpService","calendar","router","sharedService","hora","required","donacion","ngOnInit","sinSeleccionar","fecha","getToday","transFecha","compRegistro","registrado","localStorage","getItem","console","log","fechaCalendar","fechaSeleccionada","year","month","day","traerHorario","fetchHorasDisponibles","subscribe","resp","horasDisponibles","horas","length","noHayHoras","setDia","event","pedirCita","id","JSON","parse","fechaCita","citaForm","get","value","tipoDonacion","insertCita","success","citaPedida","next","complete","navigate","selectors","outputs","onCitaPedida","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["/home/mario/donantesSangrePuertollano/front/src/app/citas/pedir-cita-paciente/pedir-cita-paciente.component.ts","/home/mario/donantesSangrePuertollano/front/src/app/citas/pedir-cita-paciente/pedir-cita-paciente.component.html"],"sourcesContent":["import { Component, ViewChild, ElementRef, Output, EventEmitter } from '@angular/core';\nimport { CitasService } from '../services/citas.service';\nimport { FormControl, FormGroup, Validators, FormsModule } from '@angular/forms';\nimport { NgbDateStruct, NgbCalendar, NgbDatepickerModule } from '@ng-bootstrap/ng-bootstrap';\nimport { DatePickerComponent } from '../date-picker/date-picker.component';\nimport { CommonModule } from '@angular/common';\nimport { Route, Router } from '@angular/router';\nimport { SharedService } from 'src/app/shared/services/shared.service';\n\n\n\n@Component({\n  selector: 'app-pedir-cita-paciente',\n  templateUrl: './pedir-cita-paciente.component.html',\n  styleUrls: ['./pedir-cita-paciente.component.scss'],\n})\nexport class PedirCitaPacienteComponent {\n\n  @Output() onCitaPedida: EventEmitter<boolean> = new EventEmitter();\n\n  fecha: NgbDateStruct;\n  sinSeleccionar = true;\n  registrado: boolean = false;\n  noHayHoras: boolean = false;\n  horasDisponibles: string[] = [];\n  fechaSeleccionada: string;\n  citaPedida: number = -1;\n\n  citaForm: FormGroup = new FormGroup({\n    hora: new FormControl('', [Validators.required]),\n    donacion: new FormControl('sangre', [Validators.required])\n  });\n\n\n  constructor(\n    private pedirCitaHttpService: CitasService,\n    private calendar: NgbCalendar,\n    private router: Router,\n    private sharedService: SharedService\n    ) {}\n\n  ngOnInit() {\n    this.sinSeleccionar = true;\n    this.fecha = this.calendar.getToday();\n    this.transFecha(this.fecha);\n    this.compRegistro();\n  }\n\n\n  compRegistro() {\n     this.registrado = localStorage.getItem('user') != null;\n     console.log(this.registrado);\n  }\n\n\n  transFecha(fechaCalendar: NgbDateStruct) {\n    console.log('fecha');\n    console.log(this.fecha);\n    this.fechaSeleccionada = this.fecha.year + '-' + this.fecha.month + '-' + this.fecha.day;\n  }\n\n\n  traerHorario() {\n    this.pedirCitaHttpService.fetchHorasDisponibles(this.fechaSeleccionada).subscribe(resp => {\n      this.horasDisponibles = resp.horas;\n      console.log(this.horasDisponibles);\n      if (this.horasDisponibles.length == 0) this.noHayHoras = true;\n    });\n  }\n\n\n  setDia(event: NgbDateStruct) {\n    this.fecha = event;\n    this.transFecha(this.fecha);\n    this.traerHorario();\n    this.sinSeleccionar = false;\n  }\n\n\n  pedirCita() {\n    const id = JSON.parse(localStorage.getItem('user') || '{}').id;\n    console.log(id);\n    const fechaCita = this.fechaSeleccionada\n      + ' ' + this.citaForm.get('hora')?.value + ':00';\n\n    const tipoDonacion = this.citaForm.get('donacion')?.value;\n\n    this.pedirCitaHttpService.insertCita(id, fechaCita, tipoDonacion).subscribe(resp => {\n      if (resp.success) {\n\n        console.log('asdfasdfasdfasdf');\n        // this.onCitaPedida.emit(true);\n        this.sharedService.citaPedida.next(0);\n        this.sharedService.citaPedida.complete();\n\n      }\n      else {\n\n        this.sharedService.citaPedida.next(1);\n      }\n\n      this.router.navigate(['']);\n    });\n  }\n}\n","<!-- <div *ngIf=\"this.registradoExito == 0\" class=\"alert alert-success alert-dismissible position-fixed fade show ms-3\" role=\"alert\">\n  El registro se ha realizado correctamente. Te hemos mandado un correo de confirmación.\n  Pincha en el enlace para poder acceder con tu cuenta.\n  <a (click)=\"irAlLogin()\" class=\"pe-auto\"><strong>Ir al login</strong></a>. -->\n\n  <div class=\"container-fluid fondo px-2 py-5 p-md-5\">\n    <div class=\"row\">\n      <div class=\"col-0 col-sm-1 col-lg-2\"></div>\n  \n      <div class=\"col-12 col-sm-10 col-lg-8 contenedor\">\n        <div class=\"card border-0 rounded-0 w-100 mb-0\">\n          <div class=\"card-header d-flex justify-content-center align-items-center py-1 border-bottom-0\">\n            <h1>Pedir cita</h1>\n          </div>\n          <div class=\"card-body p-5 mt-5\">\n            <form [formGroup]=\"citaForm\" (ngSubmit)=\"pedirCita()\">\n              <div class=\"row\">\n                <div class=\"col-12 col-md-6 d-flex justify-content-center mb-4 mb-md-0\">\n                  <app-date-picker (onNuevaFecha)=\"setDia($event)\"></app-date-picker>\n                </div>\n                <div class=\"col-12 col-md-6\">\n                  <div class=\"row\">\n                    <div class=\"col-12\">\n                      <select formControlName=\"hora\" name=\"hora\" class=\"form-select form-select-sm mb-3\">\n                        <option *ngIf=\"this.sinSeleccionar\" value=\"\" disabled selected hidden>Selecciona una hora</option>\n                        <option value=\"\" disabled selected hidden>Horas disponibles</option>\n                        <option *ngIf=\"this.noHayHoras\">\n                          No hay horas disponibles\n                        </option>\n                        <option *ngFor=\"let hora of this.horasDisponibles\" value=\"{{ hora }}\">\n                          {{ hora }}\n                        </option>\n                      </select>\n                    </div>\n                    <div class=\"col-12\">\n                      <select formControlName=\"donacion\" name=\"donacion\" class=\"form-select form-select-sm\">\n                        <option value=\"sangre\" selected>Sangre</option>\n                        <option value=\"plasma\">Plasma</option>\n                      </select>\n                    </div>\n                  </div>\n                </div>\n              </div>\n  \n              <div class=\"card-body p-0 mt-5\">\n                <button type=\"submit\" class=\"btn w-100 btnAceptar mb-3\" [disabled]=\"citaForm.invalid\">Aceptar</button>\n                <button type=\"button\" class=\"btn w-100 border-red\">Cancelar</button>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n  \n      <div class=\"col-0 col-sm-1 col-lg-3\"></div>\n    </div>\n  </div>\n  \n  \n  \n  "]},"metadata":{},"sourceType":"module","externalDependencies":[]}