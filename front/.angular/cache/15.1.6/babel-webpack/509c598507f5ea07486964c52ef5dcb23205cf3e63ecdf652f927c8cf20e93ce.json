{"ast":null,"code":"import _asyncToGenerator from \"/home/mario/donantesSangrePuertollano/front/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { CommonModule } from '@angular/common';\nimport { NgbDatepickerModule } from '@ng-bootstrap/ng-bootstrap';\nimport { firstValueFrom } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ng-bootstrap/ng-bootstrap\";\nimport * as i2 from \"src/app/citas/services/citas.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@angular/common\";\nconst _c0 = [\"content\"];\nfunction ModalPedirCitaComponent_ng_template_0_h4_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h4\", 8);\n    i0.ɵɵtext(1, \"Inicio de sesi\\u00F3n necesario.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ModalPedirCitaComponent_ng_template_0_h4_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h4\", 8);\n    i0.ɵɵtext(1, \"Ya has pedido una cita.\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ModalPedirCitaComponent_ng_template_0_p_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \" Es necesario que inicies sesi\\u00F3n para poder pedir cita. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ModalPedirCitaComponent_ng_template_0_p_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\");\n    i0.ɵɵtext(1, \" Solamente es posible reservar una cita a la vez. \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ModalPedirCitaComponent_ng_template_0_button_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 9);\n    i0.ɵɵlistener(\"click\", function ModalPedirCitaComponent_ng_template_0_button_7_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r8.irAlLogin());\n    });\n    i0.ɵɵtext(1, \"Iniciar sesi\\u00F3n\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ModalPedirCitaComponent_ng_template_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 1);\n    i0.ɵɵtemplate(1, ModalPedirCitaComponent_ng_template_0_h4_1_Template, 2, 0, \"h4\", 2);\n    i0.ɵɵtemplate(2, ModalPedirCitaComponent_ng_template_0_h4_2_Template, 2, 0, \"h4\", 2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 3);\n    i0.ɵɵtemplate(4, ModalPedirCitaComponent_ng_template_0_p_4_Template, 2, 0, \"p\", 4);\n    i0.ɵɵtemplate(5, ModalPedirCitaComponent_ng_template_0_p_5_Template, 2, 0, \"p\", 4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"div\", 5);\n    i0.ɵɵtemplate(7, ModalPedirCitaComponent_ng_template_0_button_7_Template, 2, 0, \"button\", 6);\n    i0.ɵɵelementStart(8, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function ModalPedirCitaComponent_ng_template_0_Template_button_click_8_listener() {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.atras());\n    });\n    i0.ɵɵtext(9, \"Atr\\u00E1s\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.registrado);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.registrado && ctx_r1.puedePedirCita);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.registrado);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r1.registrado && !ctx_r1.puedePedirCita);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !ctx_r1.registrado);\n  }\n}\nexport class ModalPedirCitaComponent {\n  constructor(modalService, citasService, router) {\n    this.modalService = modalService;\n    this.citasService = citasService;\n    this.router = router;\n    this.closeResult = '';\n    this.registrado = false;\n    this.puedePedirCita = false;\n  }\n  ngAfterViewInit() {\n    this.openModal();\n  }\n  openModal() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      const user = localStorage.getItem('user');\n      console.log('2');\n      let id;\n      if (user) {\n        _this.registrado = true;\n        id = JSON.parse(user).id;\n        const resp = yield firstValueFrom(_this.citasService.compHaPedidoCita(id));\n        console.log(resp);\n        _this.puedePedirCita = resp.success;\n      } else {\n        _this.registrado = false;\n      }\n      if (!_this.registrado || !_this.puedePedirCita) {\n        _this.modalService.open(_this.content, {\n          centered: true\n        });\n      }\n    })();\n  }\n  open(content) {\n    this.modalService.open(content, {\n      ariaLabelledBy: 'modal-basic-title',\n      backdrop: 'static',\n      keyboard: false\n    }).result.then(result => {\n      this.closeResult = `Closed with: ${result}`;\n      console.log(this.closeResult);\n    });\n  }\n  irAlLogin() {\n    this.router.navigate(['/auth/login']);\n    this.modalService.dismissAll();\n  }\n  atras() {\n    this.modalService.dismissAll();\n  }\n}\nModalPedirCitaComponent.ɵfac = function ModalPedirCitaComponent_Factory(t) {\n  return new (t || ModalPedirCitaComponent)(i0.ɵɵdirectiveInject(i1.NgbModal), i0.ɵɵdirectiveInject(i2.CitasService), i0.ɵɵdirectiveInject(i3.Router));\n};\nModalPedirCitaComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: ModalPedirCitaComponent,\n  selectors: [[\"app-modal-pedir-cita\"]],\n  viewQuery: function ModalPedirCitaComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(_c0, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.content = _t.first);\n    }\n  },\n  standalone: true,\n  features: [i0.ɵɵStandaloneFeature],\n  decls: 5,\n  vars: 1,\n  consts: [[\"content\", \"\"], [1, \"modal-header\"], [\"class\", \"modal-title titulo\", \"id\", \"modal-basic-title\", 4, \"ngIf\"], [1, \"modal-body\", \"px-1\", \"py-5\", \"px-md-3\", \"p-lg-5\"], [4, \"ngIf\"], [1, \"modal-footer\", \"border-0\"], [\"type\", \"button\", \"class\", \"btn btn-primario\", 3, \"click\", 4, \"ngIf\"], [\"type\", \"button\", 1, \"btn\", \"btn-secundario\", 3, \"click\"], [\"id\", \"modal-basic-title\", 1, \"modal-title\", \"titulo\"], [\"type\", \"button\", 1, \"btn\", \"btn-primario\", 3, \"click\"]],\n  template: function ModalPedirCitaComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵtemplate(0, ModalPedirCitaComponent_ng_template_0_Template, 10, 5, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵelement(2, \"hr\");\n      i0.ɵɵelementStart(3, \"pre\");\n      i0.ɵɵtext(4);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(4);\n      i0.ɵɵtextInterpolate(ctx.closeResult);\n    }\n  },\n  dependencies: [NgbDatepickerModule, CommonModule, i4.NgIf],\n  styles: [\".modal-backdrop.fade[_ngcontent-%COMP%] {\\n  opacity: 0 !important;\\n  transition: none !important;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvc2hhcmVkL21vZGFsLXBlZGlyLWNpdGEvbW9kYWwtcGVkaXItY2l0YS5jb21wb25lbnQuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLHFCQUFBO0VBQ0EsMkJBQUE7QUFDSiIsInNvdXJjZXNDb250ZW50IjpbIi5tb2RhbC1iYWNrZHJvcC5mYWRlIHtcbiAgICBvcGFjaXR5OiAwICFpbXBvcnRhbnQ7XG4gICAgdHJhbnNpdGlvbjogbm9uZSAhaW1wb3J0YW50O1xuICB9Il0sInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"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","names":["CommonModule","NgbDatepickerModule","firstValueFrom","i0","ModalPedirCitaComponent","constructor","modalService","citasService","router","ngAfterViewInit","openModal","user","localStorage","getItem","console","log","id","registrado","JSON","parse","resp","compHaPedidoCita","puedePedirCita","success","open","content","centered","ariaLabelledBy","backdrop","keyboard","result","then","closeResult","irAlLogin","navigate","dismissAll","atras","selectors","viewQuery","styles"],"sourceRoot":"","sources":["/home/mario/donantesSangrePuertollano/front/src/app/shared/modal-pedir-cita/modal-pedir-cita.component.ts","/home/mario/donantesSangrePuertollano/front/src/app/shared/modal-pedir-cita/modal-pedir-cita.component.html"],"sourcesContent":["import { Component, ElementRef, ViewChild } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Router } from '@angular/router';\nimport { NgbDatepickerModule, NgbModal } from '@ng-bootstrap/ng-bootstrap';\nimport { CitasService } from 'src/app/citas/services/citas.service';\nimport { RegistroComponent } from 'src/app/auth/registro/registro.component';\nimport { firstValueFrom } from 'rxjs';\n\n@Component({\n  selector: 'app-modal-pedir-cita',\n  standalone: true,\n\timports: [NgbDatepickerModule, CommonModule],\n  templateUrl: './modal-pedir-cita.component.html',\n  styleUrls: ['./modal-pedir-cita.component.scss']\n})\nexport class ModalPedirCitaComponent {\n  closeResult = '';\n  registrado = false;\n  puedePedirCita = false;\n\n  @ViewChild('content') content!: ElementRef;\n\t\n  constructor(\n    private modalService: NgbModal,\n    private citasService: CitasService,\n    private router: Router) {}\n\n\n  ngAfterViewInit() {\n    this.openModal();\n  }\n\n  async openModal(){\n\n    const user = localStorage.getItem('user');\n\n    console.log('2');\n\n    let id: string;\n    if (user) {\n      this.registrado = true;\n      id = JSON.parse(user).id;\n\n      const resp = await firstValueFrom(this.citasService.compHaPedidoCita(id));\n      \n      console.log(resp);\n      this.puedePedirCita = resp.success;\n    }\n    else {\n      this.registrado = false;\n    }\n\n\n    if (!this.registrado || !this.puedePedirCita) {\n      this.modalService.open(this.content, { centered: true });\n    }\n  }\n\n\topen(content: any) {\n    this.modalService.open(content, { ariaLabelledBy: 'modal-basic-title', backdrop: 'static', keyboard: false }).result.then(\n      (result) => {\n        this.closeResult = `Closed with: ${result}`;\n        console.log(this.closeResult);\n      }\n    );\n\t}\n\n\n  irAlLogin() {\n    this.router.navigate(['/auth/login']);\n    this.modalService.dismissAll();\n  }\n\n  atras() {\n    this.modalService.dismissAll();\n  }\n\n}\n","<ng-template #content let-modal>\n\t<div class=\"modal-header\">\n\t\t<h4 *ngIf=\"!this.registrado\"\n\t\t\tclass=\"modal-title titulo\" id=\"modal-basic-title\">Inicio de sesión necesario.</h4>\n\t\t<h4 *ngIf=\"this.registrado && this.puedePedirCita\"\n\t\t\tclass=\"modal-title titulo\" id=\"modal-basic-title\">Ya has pedido una cita.</h4>\n\t</div>\n\t<div class=\"modal-body px-1 py-5 px-md-3 p-lg-5\">\n\t\t<p *ngIf=\"!this.registrado\">\n\t\t\tEs necesario que inicies sesión para poder pedir cita.\n\t\t</p>\n\n\t\t<p *ngIf=\"this.registrado && !this.puedePedirCita\">\n\t\t\tSolamente es posible reservar una cita a la vez.\n\t\t</p>\n\t</div>\n\t<div class=\"modal-footer border-0\">\n\t\t<button *ngIf=\"!this.registrado\"\n\t\t\ttype=\"button\" class=\"btn btn-primario\" (click)=\"irAlLogin()\">Iniciar sesión</button>\n        <button type=\"button\" class=\"btn btn-secundario\" (click)=\"atras()\">Atrás</button>\n\t</div>\n</ng-template>\n\n\n<hr/>\n\n<pre>{{ closeResult }}</pre>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}