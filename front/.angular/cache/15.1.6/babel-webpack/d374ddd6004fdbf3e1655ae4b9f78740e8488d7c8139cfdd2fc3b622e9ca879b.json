{"ast":null,"code":"import { zip } from 'rxjs';\nimport * as moment from 'moment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../services/citas.service\";\nimport * as i2 from \"@angular/common\";\nfunction MostrarCitasComponent_li_15_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\", 15)(1, \"div\", 16)(2, \"div\", 17);\n    i0.ɵɵtext(3, \" No hay citas pendientes \");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction MostrarCitasComponent_ng_template_16_li_0_button_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r12 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 27);\n    i0.ɵɵlistener(\"click\", function MostrarCitasComponent_ng_template_16_li_0_button_10_Template_button_click_0_listener($event) {\n      i0.ɵɵrestoreView(_r12);\n      const ctx_r11 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r11.cancelarCita($event));\n    });\n    i0.ɵɵtext(1, \"Cancelar\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MostrarCitasComponent_ng_template_16_li_0_ng_template_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 28);\n    i0.ɵɵtext(1, \"cancelada\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MostrarCitasComponent_ng_template_16_li_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\")(1, \"div\", 19)(2, \"div\", 20)(3, \"span\", 21);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"span\", 22);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"span\", 23);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 24);\n    i0.ɵɵtemplate(10, MostrarCitasComponent_ng_template_16_li_0_button_10_Template, 2, 0, \"button\", 25);\n    i0.ɵɵtemplate(11, MostrarCitasComponent_ng_template_16_li_0_ng_template_11_Template, 2, 0, \"ng-template\", null, 26, i0.ɵɵtemplateRefExtractor);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const cita_r7 = ctx.$implicit;\n    const _r9 = i0.ɵɵreference(12);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(cita_r7.dia);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(cita_r7.hora);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(cita_r7.donacion);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", !cita_r7.cancelada)(\"ngIfElse\", _r9);\n  }\n}\nfunction MostrarCitasComponent_ng_template_16_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, MostrarCitasComponent_ng_template_16_li_0_Template, 13, 5, \"li\", 18);\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r2.citasPendientes);\n  }\n}\nfunction MostrarCitasComponent_li_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\")(1, \"div\", 16)(2, \"div\", 17);\n    i0.ɵɵtext(3, \" No reservaste ninguna cita \");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction MostrarCitasComponent_ng_template_22_li_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\")(1, \"div\", 19)(2, \"div\", 20)(3, \"span\", 21);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"span\", 22);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"span\", 23);\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"span\", 28);\n    i0.ɵɵtext(10, \"asistida\");\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const cita_r14 = ctx.$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(cita_r14.dia);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(cita_r14.hora);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(cita_r14.donacion);\n  }\n}\nfunction MostrarCitasComponent_ng_template_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, MostrarCitasComponent_ng_template_22_li_0_Template, 11, 3, \"li\", 18);\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r5.citasPasadas);\n  }\n}\nexport class MostrarCitasComponent {\n  constructor(citasService) {\n    this.citasService = citasService;\n    this.citasPendientes = [];\n    this.citasPasadas = [];\n    this.errorTraerCitas = false;\n    this.noHayCitasPendientes = false;\n    this.noHayCitasPasadas = false;\n  }\n  ngOnInit() {\n    this.traerCitas();\n  }\n  traerCitas() {\n    const id = JSON.parse(localStorage.getItem('user')).id;\n    zip([this.citasService.fetchCitaPendiente(id), this.citasService.fetchCitasPasadas(id)]).subscribe(([citasPendientesResp, citasPasadasResp]) => {\n      if (citasPendientesResp.success && citasPasadasResp.success) {\n        this.colocarCitas(citasPendientesResp.citas, this.citasPendientes);\n        this.colocarCitas(citasPasadasResp.citas, this.citasPasadas);\n        console.log(this.citasPendientes);\n        console.log(this.citasPasadas);\n        if (this.citasPendientes.length == 0) this.noHayCitasPendientes = true;\n        if (this.citasPasadas.length == 0) this.noHayCitasPasadas = true;\n        console.log('noHayCitasPendientes');\n        console.log(this.noHayCitasPendientes);\n        console.log('noHayCitasPendientes');\n        console.log(this.noHayCitasPasadas);\n      } else {\n        console.log('else');\n        this.errorTraerCitas = true;\n      }\n    });\n  }\n  colocarCitas(citas, array) {\n    citas.forEach(cita => {\n      const fechaCompletaPas = moment(cita.fecha, 'YYYY-MM-DD HH:mm:ss');\n      array.push({\n        id: cita.id,\n        dia: fechaCompletaPas.format('DD/MM/YYYY'),\n        hora: fechaCompletaPas.format('HH:mm'),\n        donacion: cita.donacion,\n        cancelada: cita.cancelada\n      });\n    });\n  }\n  cancelarCita(event) {\n    const liElement = event.target.closest('li');\n    const listItems = Array.from(liElement.parentElement.children);\n    const index = listItems.indexOf(liElement);\n    const id = this.citasPendientes[index].id;\n    // const confirm = await getConfirmacion();\n    this.citasService.cancelarCita(id).subscribe(resp => {\n      if (resp.success) {\n        this.citasPendientes[index].cancelada = true;\n      } else {\n        // TODO: cartelito de fallo\n      }\n    });\n  }\n}\nMostrarCitasComponent.ɵfac = function MostrarCitasComponent_Factory(t) {\n  return new (t || MostrarCitasComponent)(i0.ɵɵdirectiveInject(i1.CitasService));\n};\nMostrarCitasComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: MostrarCitasComponent,\n  selectors: [[\"app-mostrar-citas\"]],\n  decls: 24,\n  vars: 4,\n  consts: [[1, \"container-fluid\", \"fondo\", \"px-2\", \"py-5\", \"p-md-5\"], [1, \"row\"], [1, \"col-xl-2\", \"col-md-1\", \"col-0\"], [1, \"col-xl-8\", \"col-md-10\", \"col-0\", \"contenedor\"], [1, \"card\", \"border-0\", \"rounded-0\", \"w-100\", \"mb-0\"], [1, \"card-header\", \"d-flex\", \"justify-content-center\", \"align-items-center\", \"py-1\", \"border-bottom-0\"], [1, \"card-body\", \"px-2\", \"py-5\", \"px-md-5\", \"mt-5\", \"mb-0\"], [1, \"col-12\"], [1, \"mb-5\"], [1, \"titulo\", \"mb-3\"], [\"class\", \"my-3\", 4, \"ngIf\", \"ngIfElse\"], [\"elseCitasPendientes\", \"\"], [1, \"titulo\", \"mt-5\", \"mb-3\"], [4, \"ngIf\", \"ngIfElse\"], [\"elseCitasPasadas\", \"\"], [1, \"my-3\"], [1, \"card\", \"w-100\", \"p-0\", \"my-3\"], [1, \"card-body\", \"my-2\", \"w-100\", \"d-flex\", \"justify-content-around\", \"align-items-center\", \"tarjetaNoHay\"], [4, \"ngFor\", \"ngForOf\"], [1, \"card\", \"p-0\", \"my-3\"], [1, \"card-body\", \"my-0\", \"d-flex\", \"justify-content-around\", \"align-items-center\", \"tarjeta\"], [1, \"dia\"], [1, \"hora\"], [1, \"donacion\", \"text-center\"], [1, \"align-items-center\"], [\"class\", \"btnCancelar px-3\", 3, \"click\", 4, \"ngIf\", \"ngIfElse\"], [\"elseCancelada\", \"\"], [1, \"btnCancelar\", \"px-3\", 3, \"click\"], [1, \"derechaTexto\", \"text-center\"]],\n  template: function MostrarCitasComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1);\n      i0.ɵɵelement(2, \"div\", 2);\n      i0.ɵɵelementStart(3, \"div\", 3)(4, \"div\", 4)(5, \"div\", 5)(6, \"h1\");\n      i0.ɵɵtext(7, \"Mis citas\");\n      i0.ɵɵelementEnd()();\n      i0.ɵɵelementStart(8, \"div\", 6)(9, \"div\", 1)(10, \"div\", 7)(11, \"div\", 8)(12, \"h3\", 9);\n      i0.ɵɵtext(13, \"Citas pendientes\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(14, \"ul\");\n      i0.ɵɵtemplate(15, MostrarCitasComponent_li_15_Template, 4, 0, \"li\", 10);\n      i0.ɵɵtemplate(16, MostrarCitasComponent_ng_template_16_Template, 1, 1, \"ng-template\", null, 11, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(18, \"h3\", 12);\n      i0.ɵɵtext(19, \"Citas pasadas\");\n      i0.ɵɵelementEnd();\n      i0.ɵɵelementStart(20, \"ul\");\n      i0.ɵɵtemplate(21, MostrarCitasComponent_li_21_Template, 4, 0, \"li\", 13);\n      i0.ɵɵtemplate(22, MostrarCitasComponent_ng_template_22_Template, 1, 1, \"ng-template\", null, 14, i0.ɵɵtemplateRefExtractor);\n      i0.ɵɵelementEnd()()()()()()()()();\n    }\n    if (rf & 2) {\n      const _r1 = i0.ɵɵreference(17);\n      const _r4 = i0.ɵɵreference(23);\n      i0.ɵɵadvance(15);\n      i0.ɵɵproperty(\"ngIf\", ctx.noHayCitasPendientes)(\"ngIfElse\", _r1);\n      i0.ɵɵadvance(6);\n      i0.ɵɵproperty(\"ngIf\", ctx.noHayCitasPasadas)(\"ngIfElse\", _r4);\n    }\n  },\n  dependencies: [i2.NgForOf, i2.NgIf],\n  styles: [\"div.alert[_ngcontent-%COMP%] {\\n  z-index: 9000;\\n  width: 25rem;\\n}\\ndiv.alert[_ngcontent-%COMP%]   a[_ngcontent-%COMP%] {\\n  text-decoration: none;\\n  color: rgb(9, 43, 9);\\n}\\ndiv.alert[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover {\\n  color: rgb(2, 51, 2);\\n}\\n\\ndiv.container-fluid[_ngcontent-%COMP%] {\\n  background-color: var(--color-contraste);\\n  min-height: 80vh;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%] {\\n  box-shadow: 0 3px 9px rgba(0, 0, 0, 0.5);\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-header[_ngcontent-%COMP%] {\\n  background-color: var(--color-primario);\\n  font-family: var(--tipo-titulos);\\n  color: var(--bs-white);\\n  height: 9rem;\\n  border-radius: 2px 2px 0px 0px;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%] {\\n  margin-bottom: 2.5rem;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] {\\n  list-style: none;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .tarjetaNoHay[_ngcontent-%COMP%] {\\n  height: 5rem;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .tarjeta[_ngcontent-%COMP%] {\\n  height: 4rem;\\n  border-radius: 2px;\\n  background-color: var(--color-contraste);\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .tarjeta[_ngcontent-%COMP%]   span.dia[_ngcontent-%COMP%] {\\n  width: 6rem;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .tarjeta[_ngcontent-%COMP%]   span.hora[_ngcontent-%COMP%] {\\n  width: 3rem;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .tarjeta[_ngcontent-%COMP%]   span.donacion[_ngcontent-%COMP%] {\\n  width: 5.5rem;\\n  max-width: 5.5rem;\\n  border-left: 1px solid;\\n  border-right: 1px solid;\\n  border-color: var(--granate-oscuro);\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .tarjeta[_ngcontent-%COMP%]   span.derechaTexto[_ngcontent-%COMP%] {\\n  width: 6rem;\\n  max-width: 6rem;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   .tarjeta[_ngcontent-%COMP%]   span.derechaBoton[_ngcontent-%COMP%] {\\n  height: 100%;\\n  width: 6rem;\\n  max-width: 6rem;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   button[_ngcontent-%COMP%] {\\n  border-radius: 2px;\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   button.btnCancelar[_ngcontent-%COMP%] {\\n  background-color: var(--color-secundario);\\n  color: var(--bs-white);\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   button.btnCancelar[_ngcontent-%COMP%]:hover {\\n  background-color: var(--color-primario);\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   button.border-red[_ngcontent-%COMP%] {\\n  border: solid 1px var(--color-secundario);\\n  color: var(--color-secundario);\\n}\\ndiv.container-fluid[_ngcontent-%COMP%]   div.card[_ngcontent-%COMP%]   div.card-body[_ngcontent-%COMP%]   button.border-red[_ngcontent-%COMP%]:hover {\\n  background-color: var(--color-contraste);\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY2l0YXMvbW9zdHJhci1jaXRhcy9tb3N0cmFyLWNpdGFzLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQ0ksYUFBQTtFQUNBLFlBQUE7QUFDSjtBQUNJO0VBQ0kscUJBQUE7RUFDQSxvQkFBQTtBQUNSO0FBQ1E7RUFDSSxvQkFBQTtBQUNaOztBQUlBO0VBQ0ksd0NBQUE7RUFDQSxnQkFBQTtBQURKO0FBR0k7RUFDSSx3Q0FBQTtBQURSO0FBS1E7RUFDSSx1Q0FBQTtFQUNBLGdDQUFBO0VBQ0Esc0JBQUE7RUFDQSxZQUFBO0VBRUEsOEJBQUE7QUFKWjtBQU9RO0VBQ0kscUJBQUE7QUFMWjtBQU9ZO0VBQ0ksZ0JBQUE7QUFMaEI7QUFPZ0I7RUFDSSxZQUFBO0FBTHBCO0FBUWdCO0VBQ0ksWUFBQTtFQUNBLGtCQUFBO0VBQ0Esd0NBQUE7QUFOcEI7QUFTb0I7RUFDSSxXQUFBO0FBUHhCO0FBVW9CO0VBQ0ksV0FBQTtBQVJ4QjtBQVdvQjtFQUNJLGFBQUE7RUFDQSxpQkFBQTtFQUNBLHNCQUFBO0VBQ0EsdUJBQUE7RUFDQSxtQ0FBQTtBQVR4QjtBQVlvQjtFQUNJLFdBQUE7RUFDQSxlQUFBO0FBVnhCO0FBYW9CO0VBQ0ksWUFBQTtFQUNBLFdBQUE7RUFDQSxlQUFBO0FBWHhCO0FBa0JZO0VBb0JJLGtCQUFBO0FBbkNoQjtBQWdCZ0I7RUFDSSx5Q0FBQTtFQUNBLHNCQUFBO0FBZHBCO0FBZ0JvQjtFQUNJLHVDQUFBO0FBZHhCO0FBa0JnQjtFQUNJLHlDQUFBO0VBQ0EsOEJBQUE7QUFoQnBCO0FBa0JvQjtFQUNJLHdDQUFBO0FBaEJ4QiIsInNvdXJjZXNDb250ZW50IjpbImRpdi5hbGVydCB7XG4gICAgei1pbmRleDogOTAwMDtcbiAgICB3aWR0aDogMjVyZW07XG5cbiAgICBhIHtcbiAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xuICAgICAgICBjb2xvcjogcmdiKDksIDQzLCA5KTtcblxuICAgICAgICAmOmhvdmVyIHtcbiAgICAgICAgICAgIGNvbG9yOiByZ2IoMiwgNTEsIDIpO1xuICAgICAgICB9XG4gICAgfVxufVxuXG5kaXYuY29udGFpbmVyLWZsdWlkIHtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jb2xvci1jb250cmFzdGUpO1xuICAgIG1pbi1oZWlnaHQ6IDgwdmg7XG5cbiAgICBkaXYuY2FyZCB7XG4gICAgICAgIGJveC1zaGFkb3c6IDAgM3B4IDlweCByZ2JhKDAsIDAsIDAsIC41KTtcbiAgICAgICAgLy8gd2lkdGg6IDQwdnc7XG5cbiAgICAgICAgXG4gICAgICAgIGRpdi5jYXJkLWhlYWRlciB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jb2xvci1wcmltYXJpbyk7XG4gICAgICAgICAgICBmb250LWZhbWlseTogdmFyKC0tdGlwby10aXR1bG9zKTtcbiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1icy13aGl0ZSk7XG4gICAgICAgICAgICBoZWlnaHQ6IDlyZW07XG5cbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDJweCAycHggMHB4IDBweDtcbiAgICAgICAgfVxuXG4gICAgICAgIGRpdi5jYXJkLWJvZHkge1xuICAgICAgICAgICAgbWFyZ2luLWJvdHRvbTogMi41cmVtO1xuXG4gICAgICAgICAgICB1bCB7XG4gICAgICAgICAgICAgICAgbGlzdC1zdHlsZTogbm9uZTtcblxuICAgICAgICAgICAgICAgIC50YXJqZXRhTm9IYXkge1xuICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDVyZW07XG4gICAgICAgICAgICAgICAgfVxuICAgIFxuICAgICAgICAgICAgICAgIC50YXJqZXRhIHtcbiAgICAgICAgICAgICAgICAgICAgaGVpZ2h0OiA0cmVtO1xuICAgICAgICAgICAgICAgICAgICBib3JkZXItcmFkaXVzOiAycHg7XG4gICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWNvbG9yLWNvbnRyYXN0ZSk7XG4gICAgICAgICAgICAgICAgICAgIC8vIGJveC1zaGFkb3c6IDJweCAycHggMnB4IDJweCAjODg4ODg4O1xuICAgIFxuICAgICAgICAgICAgICAgICAgICBzcGFuLmRpYSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogNnJlbTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgIFxuICAgICAgICAgICAgICAgICAgICBzcGFuLmhvcmEge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2lkdGg6IDNyZW07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICBcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi5kb25hY2lvbiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogNS41cmVtO1xuICAgICAgICAgICAgICAgICAgICAgICAgbWF4LXdpZHRoOiA1LjVyZW07XG4gICAgICAgICAgICAgICAgICAgICAgICBib3JkZXItbGVmdDogMXB4IHNvbGlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgYm9yZGVyLXJpZ2h0OiAxcHggc29saWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICBib3JkZXItY29sb3I6IHZhcigtLWdyYW5hdGUtb3NjdXJvKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgIFxuICAgICAgICAgICAgICAgICAgICBzcGFuLmRlcmVjaGFUZXh0byB7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogNnJlbTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heC13aWR0aDogNnJlbTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgIFxuICAgICAgICAgICAgICAgICAgICBzcGFuLmRlcmVjaGFCb3RvbiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBoZWlnaHQ6IDEwMCU7XG4gICAgICAgICAgICAgICAgICAgICAgICB3aWR0aDogNnJlbTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG1heC13aWR0aDogNnJlbTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgIFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuXG4gICAgICAgICAgICBidXR0b24ge1xuICAgICAgICAgICAgICAgICYuYnRuQ2FuY2VsYXIge1xuICAgICAgICAgICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiB2YXIoLS1jb2xvci1zZWN1bmRhcmlvKTtcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLWJzLXdoaXRlKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAmOmhvdmVyIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJhY2tncm91bmQtY29sb3I6IHZhcigtLWNvbG9yLXByaW1hcmlvKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAmLmJvcmRlci1yZWQgeyAgICBcbiAgICAgICAgICAgICAgICAgICAgYm9yZGVyOiBzb2xpZCAxcHggdmFyKC0tY29sb3Itc2VjdW5kYXJpbyk7ICBcbiAgICAgICAgICAgICAgICAgICAgY29sb3I6IHZhcigtLWNvbG9yLXNlY3VuZGFyaW8pO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICY6aG92ZXIge1xuICAgICAgICAgICAgICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tY29sb3ItY29udHJhc3RlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgYm9yZGVyLXJhZGl1czogMnB4O1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cbiAgICB9XG59ICAgIFxuXG4iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n});","map":{"version":3,"mappings":"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","names":["zip","moment","i0","MostrarCitasComponent","constructor","citasService","ngOnInit","traerCitas","id","JSON","parse","localStorage","getItem","fetchCitaPendiente","fetchCitasPasadas","subscribe","citasPendientesResp","citasPasadasResp","success","colocarCitas","citas","citasPendientes","citasPasadas","console","log","length","noHayCitasPendientes","noHayCitasPasadas","errorTraerCitas","array","forEach","cita","fechaCompletaPas","fecha","push","dia","format","hora","donacion","cancelada","cancelarCita","event","liElement","target","closest","listItems","Array","from","parentElement","children","index","indexOf","resp","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["/home/mario/donantesSangrePuertollano/front/src/app/citas/mostrar-citas/mostrar-citas.component.ts","/home/mario/donantesSangrePuertollano/front/src/app/citas/mostrar-citas/mostrar-citas.component.html"],"sourcesContent":["import { Component } from '@angular/core';\nimport { concatMapTo, zip } from 'rxjs';\nimport { Cita, CitaMostrar } from '../interfaces/citas.interface';\nimport { CitasService } from '../services/citas.service';\nimport * as moment from 'moment';\n\n@Component({\n  selector: 'app-mostrar-citas',\n  templateUrl: './mostrar-citas.component.html',\n  styleUrls: ['./mostrar-citas.component.scss']\n})\nexport class MostrarCitasComponent {\n  \n  citasPendientes: CitaMostrar[] = [];\n  citasPasadas: CitaMostrar[] = [];\n  errorTraerCitas: boolean = false;\n  noHayCitasPendientes: boolean = false;\n  noHayCitasPasadas: boolean = false;\n\n  constructor(\n    private citasService: CitasService\n  ) {}\n\n  ngOnInit() {\n\n    this.traerCitas();\n  }\n\n  traerCitas() {\n\n    const id = JSON.parse(localStorage.getItem('user')!).id;\n\n    zip([this.citasService.fetchCitaPendiente(id), this.citasService.fetchCitasPasadas(id)])\n      .subscribe(([citasPendientesResp, citasPasadasResp]) => {\n\n        if (citasPendientesResp.success && citasPasadasResp.success) {\n\n          this.colocarCitas(citasPendientesResp.citas, this.citasPendientes);\n          this.colocarCitas(citasPasadasResp.citas, this.citasPasadas);\n\n          console.log(this.citasPendientes);\n          console.log(this.citasPasadas);\n\n          if (this.citasPendientes.length == 0) this.noHayCitasPendientes = true;\n          if (this.citasPasadas.length == 0) this.noHayCitasPasadas = true;\n\n          console.log('noHayCitasPendientes');\n          console.log(this.noHayCitasPendientes);\n          console.log('noHayCitasPendientes');\n          console.log(this.noHayCitasPasadas);\n        }\n        else {\n\n          console.log('else');\n          this.errorTraerCitas = true;\n        }\n      });\n  }\n\n  colocarCitas(citas: Cita[], array: CitaMostrar[]) {\n    citas.forEach(cita => {\n      const fechaCompletaPas = moment(cita.fecha, 'YYYY-MM-DD HH:mm:ss');\n      array.push({\n        id: cita.id,\n        dia: fechaCompletaPas.format('DD/MM/YYYY'),\n        hora: fechaCompletaPas.format('HH:mm'),\n        donacion: cita.donacion,\n        cancelada: cita.cancelada\n      });\n    });\n  }\n\n\n  cancelarCita(event: any) {\n    const liElement = event.target.closest('li');\n    const listItems = Array.from(liElement.parentElement.children);\n    const index = listItems.indexOf(liElement);\n\n    const id = this.citasPendientes[index].id;\n\n    // const confirm = await getConfirmacion();\n\n    this.citasService.cancelarCita(id).subscribe(resp => {\n      if (resp.success) {\n        \n        this.citasPendientes[index].cancelada = true;\n      }\n      else {\n\n        // TODO: cartelito de fallo\n      }\n    });\n  }\n}","<div class=\"container-fluid fondo px-2 py-5 p-md-5\">\n  <div class=\"row\">\n    <div class=\"col-xl-2 col-md-1 col-0\"></div>\n\n    <div class=\"col-xl-8 col-md-10 col-0 contenedor\">\n      <div class=\"card border-0 rounded-0 w-100 mb-0\">\n        <div class=\"card-header d-flex justify-content-center align-items-center py-1 border-bottom-0\">\n          <h1>Mis citas</h1>\n        </div>\n        <div class=\"card-body px-2 py-5 px-md-5 mt-5 mb-0\">\n          <div class=\"row\">\n            <div class=\"col-12\">\n              <div class=\"mb-5\">\n                <h3 class=\"titulo mb-3\">Citas pendientes</h3>\n                <ul>\n                  <li *ngIf=\"noHayCitasPendientes; else elseCitasPendientes\" class=\"my-3\">\n                    <div class=\"card w-100 p-0 my-3\">\n                      <div class=\"card-body my-2 w-100 d-flex justify-content-around align-items-center tarjetaNoHay\">\n                        No hay citas pendientes\n                      </div>\n                    </div>\n                  </li>\n\n                  <ng-template #elseCitasPendientes>\n                    <li *ngFor=\"let cita of citasPendientes\">\n                      <div class=\"card p-0 my-3\">\n                        <div class=\"card-body my-0 d-flex justify-content-around align-items-center tarjeta\">\n                          <span class=\"dia\">{{ cita.dia }}</span>\n                          <span class=\"hora\">{{ cita.hora }}</span>\n                          <span class=\"donacion text-center\">{{ cita.donacion }}</span>\n                          <div class=\"align-items-center\">\n                            <button *ngIf=\"!cita.cancelada; else elseCancelada\" class=\"btnCancelar px-3\" (click)=\"cancelarCita($event)\">Cancelar</button>\n                            <ng-template #elseCancelada>\n                              <span class=\"derechaTexto text-center\">cancelada</span>\n                            </ng-template>\n                          </div>\n                        </div>                        \n                      </div>\n                    </li>\n                  </ng-template>\n                </ul>\n\n                <h3 class=\"titulo mt-5 mb-3\">Citas pasadas</h3>\n                <ul>\n                  <li *ngIf=\"noHayCitasPasadas; else elseCitasPasadas\">\n                    <div class=\"card w-100 p-0 my-3\">\n                      <div class=\"card-body my-2 w-100 d-flex justify-content-around align-items-center tarjetaNoHay\">\n                        No reservaste ninguna cita\n                      </div>\n                    </div>\n                  </li>\n\n                  <ng-template #elseCitasPasadas>\n                    <li *ngFor=\"let cita of citasPasadas\">\n                      <div class=\"card p-0 my-3\">\n                        <div class=\"card-body my-0 d-flex justify-content-around align-items-center tarjeta\">\n                          <span class=\"dia\">{{ cita.dia }}</span>\n                          <span class=\"hora\">{{ cita.hora }}</span>\n                          <span class=\"donacion text-center\">{{ cita.donacion }}</span>\n                          <span class=\"derechaTexto text-center\">asistida</span>\n                        </div>\n                      </div>\n                    </li>\n                  </ng-template>\n                </ul>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}